// koffee 1.4.0

/*
000   000  000  000   000  0000000     0000000   000   000
000 0 000  000  0000  000  000   000  000   000  000 0 000
000000000  000  000 0 000  000   000  000   000  000000000
000   000  000  000  0000  000   000  000   000  000   000
00     00  000  000   000  0000000     0000000   00     00
 */
var $, Browser, FileBrowser, _, args, dialog, electron, fileBrowser, klog, kpos, onCombo, onContextMenu, onMenuAction, pkg, popup, post, prefs, ref, remote, scheme, setStyle, slash, stopEvent, toggleExtensions, w, win, winID, winMain;

ref = require('kxk'), post = ref.post, args = ref.args, slash = ref.slash, prefs = ref.prefs, stopEvent = ref.stopEvent, setStyle = ref.setStyle, scheme = ref.scheme, popup = ref.popup, klog = ref.klog, kpos = ref.kpos, win = ref.win, $ = ref.$, _ = ref._;

FileBrowser = require('./filebrowser');

w = new win({
    dir: __dirname,
    pkg: require('../package.json'),
    menu: '../coffee/menu.noon',
    icon: '../img/menu@2x.png',
    prefsSeperator: '▸',
    context: false,
    dragElem: $('#crumbs')
});

electron = require('electron');

pkg = require('../package.json');

remote = electron.remote;

dialog = remote.dialog;

Browser = remote.BrowserWindow;

win = window.win = remote.getCurrentWindow();

winID = window.winID = win.id;

fileBrowser = null;

winMain = function() {
    fileBrowser = new FileBrowser($("#main"));
    fileBrowser.loadItem({
        type: 'dir',
        file: slash.resolve('~')
    });
    return win.on('resize', function() {
        return fileBrowser.resized();
    });
};

onContextMenu = function(event) {
    klog('maincon');
    if (!event.target.classList.contains('crumb')) {
        return;
    }
    return fileBrowser.columns[event.target.columnIndex].onContextMenu(event, true);
};

$("#crumbs").addEventListener('contextmenu', onContextMenu);

onMenuAction = function(name, args) {
    klog('menuAction', name);
    switch (name) {
        case 'Toggle Extensions':
            return toggleExtensions();
        case 'Increase':
            return changeFontSize(+1);
        case 'Decrease':
            return changeFontSize(-1);
        case 'Reset':
            return resetFontSize();
        case 'Add to Shelf':
            return addToShelf();
        case 'Reload Window':
            return reloadWin();
    }
    return post.toMain('menuAction', name, args);
};

post.on('menuAction', onMenuAction);

toggleExtensions = function() {
    var stateKey;
    stateKey = "browser▸hideExtensions";
    prefs.set(stateKey, !prefs.get(stateKey, false));
    setStyle('.browserRow .ext', 'display', prefs.get(stateKey) && 'none' || 'initial');
    return setStyle('.fileInfoFile .ext', 'display', prefs.get(stateKey) && 'none' || 'initial');
};

onCombo = function(combo, info) {
    var char, event, key, mod;
    if (!combo) {
        return;
    }
    return mod = info.mod, key = info.key, combo = info.combo, char = info.char, event = info.event, info;
};

post.on('combo', onCombo);

winMain();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2luZG93LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUEwRixPQUFBLENBQVEsS0FBUixDQUExRixFQUFFLGVBQUYsRUFBUSxlQUFSLEVBQWMsaUJBQWQsRUFBcUIsaUJBQXJCLEVBQTRCLHlCQUE1QixFQUF1Qyx1QkFBdkMsRUFBaUQsbUJBQWpELEVBQXlELGlCQUF6RCxFQUFnRSxlQUFoRSxFQUFzRSxlQUF0RSxFQUE0RSxhQUE1RSxFQUFpRixTQUFqRixFQUFvRjs7QUFFcEYsV0FBQSxHQUFjLE9BQUEsQ0FBUSxlQUFSOztBQUVkLENBQUEsR0FBSSxJQUFJLEdBQUosQ0FDQTtJQUFBLEdBQUEsRUFBUSxTQUFSO0lBQ0EsR0FBQSxFQUFRLE9BQUEsQ0FBUSxpQkFBUixDQURSO0lBRUEsSUFBQSxFQUFRLHFCQUZSO0lBR0EsSUFBQSxFQUFRLG9CQUhSO0lBSUEsY0FBQSxFQUFnQixHQUpoQjtJQUtBLE9BQUEsRUFBUyxLQUxUO0lBTUEsUUFBQSxFQUFVLENBQUEsQ0FBRSxTQUFGLENBTlY7Q0FEQTs7QUFTSixRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBQ1gsR0FBQSxHQUFXLE9BQUEsQ0FBUSxpQkFBUjs7QUFFWCxNQUFBLEdBQVcsUUFBUSxDQUFDOztBQUNwQixNQUFBLEdBQVcsTUFBTSxDQUFDOztBQUNsQixPQUFBLEdBQVcsTUFBTSxDQUFDOztBQUNsQixHQUFBLEdBQVcsTUFBTSxDQUFDLEdBQVAsR0FBZSxNQUFNLENBQUMsZ0JBQVAsQ0FBQTs7QUFDMUIsS0FBQSxHQUFXLE1BQU0sQ0FBQyxLQUFQLEdBQWUsR0FBRyxDQUFDOztBQUM5QixXQUFBLEdBQWM7O0FBUWQsT0FBQSxHQUFVLFNBQUE7SUFFTixXQUFBLEdBQWMsSUFBSSxXQUFKLENBQWdCLENBQUEsQ0FBRSxPQUFGLENBQWhCO0lBQ2QsV0FBVyxDQUFDLFFBQVosQ0FBcUI7UUFBQSxJQUFBLEVBQUssS0FBTDtRQUFXLElBQUEsRUFBSyxLQUFLLENBQUMsT0FBTixDQUFjLEdBQWQsQ0FBaEI7S0FBckI7V0FFQSxHQUFHLENBQUMsRUFBSixDQUFPLFFBQVAsRUFBZ0IsU0FBQTtlQUFHLFdBQVcsQ0FBQyxPQUFaLENBQUE7SUFBSCxDQUFoQjtBQUxNOztBQWFWLGFBQUEsR0FBZ0IsU0FBQyxLQUFEO0lBRVosSUFBQSxDQUFLLFNBQUw7SUFFQSxJQUFVLENBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBdkIsQ0FBZ0MsT0FBaEMsQ0FBZDtBQUFBLGVBQUE7O1dBRUEsV0FBVyxDQUFDLE9BQVEsQ0FBQSxLQUFLLENBQUMsTUFBTSxDQUFDLFdBQWIsQ0FBeUIsQ0FBQyxhQUE5QyxDQUE0RCxLQUE1RCxFQUFtRSxJQUFuRTtBQU5ZOztBQVFoQixDQUFBLENBQUUsU0FBRixDQUFZLENBQUMsZ0JBQWIsQ0FBOEIsYUFBOUIsRUFBNEMsYUFBNUM7O0FBUUEsWUFBQSxHQUFlLFNBQUMsSUFBRCxFQUFPLElBQVA7SUFFWCxJQUFBLENBQUssWUFBTCxFQUFrQixJQUFsQjtBQUVBLFlBQU8sSUFBUDtBQUFBLGFBRVMsbUJBRlQ7QUFFa0MsbUJBQU8sZ0JBQUEsQ0FBQTtBQUZ6QyxhQUdTLFVBSFQ7QUFHa0MsbUJBQU8sY0FBQSxDQUFlLENBQUMsQ0FBaEI7QUFIekMsYUFJUyxVQUpUO0FBSWtDLG1CQUFPLGNBQUEsQ0FBZSxDQUFDLENBQWhCO0FBSnpDLGFBS1MsT0FMVDtBQUtrQyxtQkFBTyxhQUFBLENBQUE7QUFMekMsYUFNUyxjQU5UO0FBTWtDLG1CQUFPLFVBQUEsQ0FBQTtBQU56QyxhQU9TLGVBUFQ7QUFPa0MsbUJBQU8sU0FBQSxDQUFBO0FBUHpDO1dBU0EsSUFBSSxDQUFDLE1BQUwsQ0FBWSxZQUFaLEVBQXlCLElBQXpCLEVBQStCLElBQS9CO0FBYlc7O0FBZWYsSUFBSSxDQUFDLEVBQUwsQ0FBUSxZQUFSLEVBQXFCLFlBQXJCOztBQUVBLGdCQUFBLEdBQW1CLFNBQUE7QUFFZixRQUFBO0lBQUEsUUFBQSxHQUFXO0lBQ1gsS0FBSyxDQUFDLEdBQU4sQ0FBVSxRQUFWLEVBQW9CLENBQUksS0FBSyxDQUFDLEdBQU4sQ0FBVSxRQUFWLEVBQW9CLEtBQXBCLENBQXhCO0lBQ0EsUUFBQSxDQUFTLGtCQUFULEVBQThCLFNBQTlCLEVBQXdDLEtBQUssQ0FBQyxHQUFOLENBQVUsUUFBVixDQUFBLElBQXdCLE1BQXhCLElBQWtDLFNBQTFFO1dBQ0EsUUFBQSxDQUFTLG9CQUFULEVBQThCLFNBQTlCLEVBQXdDLEtBQUssQ0FBQyxHQUFOLENBQVUsUUFBVixDQUFBLElBQXdCLE1BQXhCLElBQWtDLFNBQTFFO0FBTGU7O0FBYW5CLE9BQUEsR0FBVSxTQUFDLEtBQUQsRUFBUSxJQUFSO0FBRU4sUUFBQTtJQUFBLElBQVUsQ0FBSSxLQUFkO0FBQUEsZUFBQTs7V0FFRSxjQUFGLEVBQU8sY0FBUCxFQUFZLGtCQUFaLEVBQW1CLGdCQUFuQixFQUF5QixrQkFBekIsRUFBbUM7QUFKN0I7O0FBV1YsSUFBSSxDQUFDLEVBQUwsQ0FBUSxPQUFSLEVBQWdCLE9BQWhCOztBQUVBLE9BQUEsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMFxuMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuMDAgICAgIDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwICAgICAwMFxuIyMjXG5cbnsgcG9zdCwgYXJncywgc2xhc2gsIHByZWZzLCBzdG9wRXZlbnQsIHNldFN0eWxlLCBzY2hlbWUsIHBvcHVwLCBrbG9nLCBrcG9zLCB3aW4sICQsIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxuRmlsZUJyb3dzZXIgPSByZXF1aXJlICcuL2ZpbGVicm93c2VyJ1xuICBcbncgPSBuZXcgd2luXG4gICAgZGlyOiAgICBfX2Rpcm5hbWVcbiAgICBwa2c6ICAgIHJlcXVpcmUgJy4uL3BhY2thZ2UuanNvbidcbiAgICBtZW51OiAgICcuLi9jb2ZmZWUvbWVudS5ub29uJ1xuICAgIGljb246ICAgJy4uL2ltZy9tZW51QDJ4LnBuZydcbiAgICBwcmVmc1NlcGVyYXRvcjogJ+KWuCdcbiAgICBjb250ZXh0OiBmYWxzZVxuICAgIGRyYWdFbGVtOiAkICcjY3J1bWJzJ1xuICAgIFxuZWxlY3Ryb24gPSByZXF1aXJlICdlbGVjdHJvbidcbnBrZyAgICAgID0gcmVxdWlyZSAnLi4vcGFja2FnZS5qc29uJ1xuXG5yZW1vdGUgICA9IGVsZWN0cm9uLnJlbW90ZVxuZGlhbG9nICAgPSByZW1vdGUuZGlhbG9nXG5Ccm93c2VyICA9IHJlbW90ZS5Ccm93c2VyV2luZG93XG53aW4gICAgICA9IHdpbmRvdy53aW4gICA9IHJlbW90ZS5nZXRDdXJyZW50V2luZG93KClcbndpbklEICAgID0gd2luZG93LndpbklEID0gd2luLmlkXG5maWxlQnJvd3NlciA9IG51bGxcblxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAwMDAgICAwMDBcbiMgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwXG4jIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDBcbiMgMDAgICAgIDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwXG5cbndpbk1haW4gPSAtPlxuXG4gICAgZmlsZUJyb3dzZXIgPSBuZXcgRmlsZUJyb3dzZXIgJCBcIiNtYWluXCJcbiAgICBmaWxlQnJvd3Nlci5sb2FkSXRlbSB0eXBlOidkaXInIGZpbGU6c2xhc2gucmVzb2x2ZSAnfidcbiAgICBcbiAgICB3aW4ub24gJ3Jlc2l6ZScgLT4gZmlsZUJyb3dzZXIucmVzaXplZCgpXG5cbiMgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwXG4jIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwXG4jIDAwMCAgICAgICAgIDAwMDAwMDAgICAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwXG5cbm9uQ29udGV4dE1lbnUgPSAoZXZlbnQpIC0+IFxuICAgIFxuICAgIGtsb2cgJ21haW5jb24nXG4gICAgXG4gICAgcmV0dXJuIGlmIG5vdCBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zICdjcnVtYidcbiAgICBcbiAgICBmaWxlQnJvd3Nlci5jb2x1bW5zW2V2ZW50LnRhcmdldC5jb2x1bW5JbmRleF0ub25Db250ZXh0TWVudSBldmVudCwgdHJ1ZVxuICAgIFxuJChcIiNjcnVtYnNcIikuYWRkRXZlbnRMaXN0ZW5lciAnY29udGV4dG1lbnUnIG9uQ29udGV4dE1lbnVcblxuIyAwMCAgICAgMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDBcbiMgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwIDAgMDAwICAwMDAgICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMFxuIyAwMDAgMCAwMDAgIDAwMCAgICAgICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcblxub25NZW51QWN0aW9uID0gKG5hbWUsIGFyZ3MpIC0+XG5cbiAgICBrbG9nICdtZW51QWN0aW9uJyBuYW1lXG4gICAgXG4gICAgc3dpdGNoIG5hbWVcblxuICAgICAgICB3aGVuICdUb2dnbGUgRXh0ZW5zaW9ucycgdGhlbiByZXR1cm4gdG9nZ2xlRXh0ZW5zaW9ucygpXG4gICAgICAgIHdoZW4gJ0luY3JlYXNlJyAgICAgICAgICB0aGVuIHJldHVybiBjaGFuZ2VGb250U2l6ZSArMVxuICAgICAgICB3aGVuICdEZWNyZWFzZScgICAgICAgICAgdGhlbiByZXR1cm4gY2hhbmdlRm9udFNpemUgLTFcbiAgICAgICAgd2hlbiAnUmVzZXQnICAgICAgICAgICAgIHRoZW4gcmV0dXJuIHJlc2V0Rm9udFNpemUoKVxuICAgICAgICB3aGVuICdBZGQgdG8gU2hlbGYnICAgICAgdGhlbiByZXR1cm4gYWRkVG9TaGVsZigpXG4gICAgICAgIHdoZW4gJ1JlbG9hZCBXaW5kb3cnICAgICB0aGVuIHJldHVybiByZWxvYWRXaW4oKVxuXG4gICAgcG9zdC50b01haW4gJ21lbnVBY3Rpb24nIG5hbWUsIGFyZ3NcblxucG9zdC5vbiAnbWVudUFjdGlvbicgb25NZW51QWN0aW9uXG5cbnRvZ2dsZUV4dGVuc2lvbnMgPSAtPlxuXG4gICAgc3RhdGVLZXkgPSBcImJyb3dzZXLilrhoaWRlRXh0ZW5zaW9uc1wiXG4gICAgcHJlZnMuc2V0IHN0YXRlS2V5LCBub3QgcHJlZnMuZ2V0IHN0YXRlS2V5LCBmYWxzZVxuICAgIHNldFN0eWxlICcuYnJvd3NlclJvdyAuZXh0JyAgICdkaXNwbGF5JyBwcmVmcy5nZXQoc3RhdGVLZXkpIGFuZCAnbm9uZScgb3IgJ2luaXRpYWwnXG4gICAgc2V0U3R5bGUgJy5maWxlSW5mb0ZpbGUgLmV4dCcgJ2Rpc3BsYXknIHByZWZzLmdldChzdGF0ZUtleSkgYW5kICdub25lJyBvciAnaW5pdGlhbCdcblxuIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDBcbiMgMDAwICAwMDAgICAwMDAgICAgICAgIDAwMCAwMDBcbiMgMDAwMDAwMCAgICAwMDAwMDAwICAgICAwMDAwMFxuIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAwMDAwMCAgICAgMDAwXG5cbm9uQ29tYm8gPSAoY29tYm8sIGluZm8pIC0+XG5cbiAgICByZXR1cm4gaWYgbm90IGNvbWJvXG5cbiAgICB7IG1vZCwga2V5LCBjb21ibywgY2hhciwgZXZlbnQgfSA9IGluZm9cblxuICAgICMgc3dpdGNoIGNvbWJvXG4gICAgICAgICMgd2hlbiAnY29tbWFuZCtzaGlmdCs9JyAgICB0aGVuIHJldHVybiBzdG9wRXZlbnQgZXZlbnQsIEBjaGFuZ2Vab29tICsxXG4gICAgICAgICMgd2hlbiAnY29tbWFuZCtzaGlmdCstJyAgICB0aGVuIHJldHVybiBzdG9wRXZlbnQgZXZlbnQsIEBjaGFuZ2Vab29tIC0xXG4gICAgICAgICMgd2hlbiAnY29tbWFuZCtzaGlmdCswJyAgICB0aGVuIHJldHVybiBzdG9wRXZlbnQgZXZlbnQsIEByZXNldFpvb20oKVxuXG5wb3N0Lm9uICdjb21ibycgb25Db21ib1xuXG53aW5NYWluKClcbiJdfQ==
//# sourceURL=../coffee/window.coffee