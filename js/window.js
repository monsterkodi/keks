// koffee 1.4.0

/*
000   000  000  000   000  0000000     0000000   000   000
000 0 000  000  0000  000  000   000  000   000  000 0 000
000000000  000  000 0 000  000   000  000   000  000000000
000   000  000  000  0000  000   000  000   000  000   000
00     00  000  000   000  0000000     0000000   00     00
 */
var $, Browser, FileBrowser, _, args, dialog, electron, fileBrowser, klog, kpos, onCombo, onContextMenu, onMenuAction, pkg, popup, post, prefs, ref, remote, scheme, setStyle, slash, stopEvent, toggleExtensions, w, win, winID, winMain;

ref = require('kxk'), post = ref.post, args = ref.args, slash = ref.slash, prefs = ref.prefs, stopEvent = ref.stopEvent, setStyle = ref.setStyle, scheme = ref.scheme, popup = ref.popup, klog = ref.klog, kpos = ref.kpos, win = ref.win, $ = ref.$, _ = ref._;

FileBrowser = require('./filebrowser');

w = new win({
    dir: __dirname,
    pkg: require('../package.json'),
    menu: '../coffee/menu.noon',
    icon: '../img/menu@2x.png',
    prefsSeperator: '▸',
    context: false,
    dragElem: $('#crumbs')
});

electron = require('electron');

pkg = require('../package.json');

remote = electron.remote;

dialog = remote.dialog;

Browser = remote.BrowserWindow;

win = window.win = remote.getCurrentWindow();

winID = window.winID = win.id;

fileBrowser = null;

winMain = function() {
    fileBrowser = new FileBrowser($("#main"));
    fileBrowser.loadItem({
        type: 'dir',
        file: slash.resolve('~')
    });
    return win.on('resize', function() {
        return fileBrowser.resized();
    });
};

onContextMenu = function(event) {
    if (!event.target.classList.contains('crumb')) {
        return;
    }
    return fileBrowser.columns[event.target.columnIndex].onContextMenu(event, true);
};

$("#crumbs").addEventListener('contextmenu', onContextMenu);

onMenuAction = function(name, args) {
    klog('menuAction', name);
    switch (name) {
        case 'Toggle Extensions':
            return toggleExtensions();
        case 'Increase':
            return changeFontSize(+1);
        case 'Decrease':
            return changeFontSize(-1);
        case 'Reset':
            return resetFontSize();
        case 'Add to Shelf':
            return addToShelf();
        case 'Reload Window':
            return reloadWin();
    }
    return post.toMain('menuAction', name, args);
};

post.on('menuAction', onMenuAction);

toggleExtensions = function() {
    var stateKey;
    stateKey = "browser▸hideExtensions";
    prefs.set(stateKey, !prefs.get(stateKey, false));
    setStyle('.browserRow .ext', 'display', prefs.get(stateKey) && 'none' || 'initial');
    return setStyle('.fileInfoFile .ext', 'display', prefs.get(stateKey) && 'none' || 'initial');
};

onCombo = function(combo, info) {
    var char, event, key, mod;
    if (!combo) {
        return;
    }
    return mod = info.mod, key = info.key, combo = info.combo, char = info.char, event = info.event, info;
};

post.on('combo', onCombo);

winMain();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2luZG93LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUEwRixPQUFBLENBQVEsS0FBUixDQUExRixFQUFFLGVBQUYsRUFBUSxlQUFSLEVBQWMsaUJBQWQsRUFBcUIsaUJBQXJCLEVBQTRCLHlCQUE1QixFQUF1Qyx1QkFBdkMsRUFBaUQsbUJBQWpELEVBQXlELGlCQUF6RCxFQUFnRSxlQUFoRSxFQUFzRSxlQUF0RSxFQUE0RSxhQUE1RSxFQUFpRixTQUFqRixFQUFvRjs7QUFFcEYsV0FBQSxHQUFjLE9BQUEsQ0FBUSxlQUFSOztBQUVkLENBQUEsR0FBSSxJQUFJLEdBQUosQ0FDQTtJQUFBLEdBQUEsRUFBUSxTQUFSO0lBQ0EsR0FBQSxFQUFRLE9BQUEsQ0FBUSxpQkFBUixDQURSO0lBRUEsSUFBQSxFQUFRLHFCQUZSO0lBR0EsSUFBQSxFQUFRLG9CQUhSO0lBSUEsY0FBQSxFQUFnQixHQUpoQjtJQUtBLE9BQUEsRUFBUyxLQUxUO0lBTUEsUUFBQSxFQUFVLENBQUEsQ0FBRSxTQUFGLENBTlY7Q0FEQTs7QUFTSixRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBQ1gsR0FBQSxHQUFXLE9BQUEsQ0FBUSxpQkFBUjs7QUFFWCxNQUFBLEdBQVcsUUFBUSxDQUFDOztBQUNwQixNQUFBLEdBQVcsTUFBTSxDQUFDOztBQUNsQixPQUFBLEdBQVcsTUFBTSxDQUFDOztBQUNsQixHQUFBLEdBQVcsTUFBTSxDQUFDLEdBQVAsR0FBZSxNQUFNLENBQUMsZ0JBQVAsQ0FBQTs7QUFDMUIsS0FBQSxHQUFXLE1BQU0sQ0FBQyxLQUFQLEdBQWUsR0FBRyxDQUFDOztBQUM5QixXQUFBLEdBQWM7O0FBUWQsT0FBQSxHQUFVLFNBQUE7SUFFTixXQUFBLEdBQWMsSUFBSSxXQUFKLENBQWdCLENBQUEsQ0FBRSxPQUFGLENBQWhCO0lBQ2QsV0FBVyxDQUFDLFFBQVosQ0FBcUI7UUFBQSxJQUFBLEVBQUssS0FBTDtRQUFXLElBQUEsRUFBSyxLQUFLLENBQUMsT0FBTixDQUFjLEdBQWQsQ0FBaEI7S0FBckI7V0FFQSxHQUFHLENBQUMsRUFBSixDQUFPLFFBQVAsRUFBZ0IsU0FBQTtlQUFHLFdBQVcsQ0FBQyxPQUFaLENBQUE7SUFBSCxDQUFoQjtBQUxNOztBQWFWLGFBQUEsR0FBZ0IsU0FBQyxLQUFEO0lBRVosSUFBVSxDQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQXZCLENBQWdDLE9BQWhDLENBQWQ7QUFBQSxlQUFBOztXQUVBLFdBQVcsQ0FBQyxPQUFRLENBQUEsS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFiLENBQXlCLENBQUMsYUFBOUMsQ0FBNEQsS0FBNUQsRUFBbUUsSUFBbkU7QUFKWTs7QUFNaEIsQ0FBQSxDQUFFLFNBQUYsQ0FBWSxDQUFDLGdCQUFiLENBQThCLGFBQTlCLEVBQTRDLGFBQTVDOztBQVFBLFlBQUEsR0FBZSxTQUFDLElBQUQsRUFBTyxJQUFQO0lBRVgsSUFBQSxDQUFLLFlBQUwsRUFBa0IsSUFBbEI7QUFFQSxZQUFPLElBQVA7QUFBQSxhQUVTLG1CQUZUO0FBRWtDLG1CQUFPLGdCQUFBLENBQUE7QUFGekMsYUFHUyxVQUhUO0FBR2tDLG1CQUFPLGNBQUEsQ0FBZSxDQUFDLENBQWhCO0FBSHpDLGFBSVMsVUFKVDtBQUlrQyxtQkFBTyxjQUFBLENBQWUsQ0FBQyxDQUFoQjtBQUp6QyxhQUtTLE9BTFQ7QUFLa0MsbUJBQU8sYUFBQSxDQUFBO0FBTHpDLGFBTVMsY0FOVDtBQU1rQyxtQkFBTyxVQUFBLENBQUE7QUFOekMsYUFPUyxlQVBUO0FBT2tDLG1CQUFPLFNBQUEsQ0FBQTtBQVB6QztXQVNBLElBQUksQ0FBQyxNQUFMLENBQVksWUFBWixFQUF5QixJQUF6QixFQUErQixJQUEvQjtBQWJXOztBQWVmLElBQUksQ0FBQyxFQUFMLENBQVEsWUFBUixFQUFxQixZQUFyQjs7QUFFQSxnQkFBQSxHQUFtQixTQUFBO0FBRWYsUUFBQTtJQUFBLFFBQUEsR0FBVztJQUNYLEtBQUssQ0FBQyxHQUFOLENBQVUsUUFBVixFQUFvQixDQUFJLEtBQUssQ0FBQyxHQUFOLENBQVUsUUFBVixFQUFvQixLQUFwQixDQUF4QjtJQUNBLFFBQUEsQ0FBUyxrQkFBVCxFQUE4QixTQUE5QixFQUF3QyxLQUFLLENBQUMsR0FBTixDQUFVLFFBQVYsQ0FBQSxJQUF3QixNQUF4QixJQUFrQyxTQUExRTtXQUNBLFFBQUEsQ0FBUyxvQkFBVCxFQUE4QixTQUE5QixFQUF3QyxLQUFLLENBQUMsR0FBTixDQUFVLFFBQVYsQ0FBQSxJQUF3QixNQUF4QixJQUFrQyxTQUExRTtBQUxlOztBQWFuQixPQUFBLEdBQVUsU0FBQyxLQUFELEVBQVEsSUFBUjtBQUVOLFFBQUE7SUFBQSxJQUFVLENBQUksS0FBZDtBQUFBLGVBQUE7O1dBRUUsY0FBRixFQUFPLGNBQVAsRUFBWSxrQkFBWixFQUFtQixnQkFBbkIsRUFBeUIsa0JBQXpCLEVBQW1DO0FBSjdCOztBQVdWLElBQUksQ0FBQyxFQUFMLENBQVEsT0FBUixFQUFnQixPQUFoQjs7QUFFQSxPQUFBLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMDAgICAwMDBcbjAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDBcbjAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDBcbjAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcbjAwICAgICAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMCAgICAgMDBcbiMjI1xuXG57IHBvc3QsIGFyZ3MsIHNsYXNoLCBwcmVmcywgc3RvcEV2ZW50LCBzZXRTdHlsZSwgc2NoZW1lLCBwb3B1cCwga2xvZywga3Bvcywgd2luLCAkLCBfIH0gPSByZXF1aXJlICdreGsnXG5cbkZpbGVCcm93c2VyID0gcmVxdWlyZSAnLi9maWxlYnJvd3NlcidcbiAgXG53ID0gbmV3IHdpblxuICAgIGRpcjogICAgX19kaXJuYW1lXG4gICAgcGtnOiAgICByZXF1aXJlICcuLi9wYWNrYWdlLmpzb24nXG4gICAgbWVudTogICAnLi4vY29mZmVlL21lbnUubm9vbidcbiAgICBpY29uOiAgICcuLi9pbWcvbWVudUAyeC5wbmcnXG4gICAgcHJlZnNTZXBlcmF0b3I6ICfilrgnXG4gICAgY29udGV4dDogZmFsc2VcbiAgICBkcmFnRWxlbTogJCAnI2NydW1icydcbiAgICBcbmVsZWN0cm9uID0gcmVxdWlyZSAnZWxlY3Ryb24nXG5wa2cgICAgICA9IHJlcXVpcmUgJy4uL3BhY2thZ2UuanNvbidcblxucmVtb3RlICAgPSBlbGVjdHJvbi5yZW1vdGVcbmRpYWxvZyAgID0gcmVtb3RlLmRpYWxvZ1xuQnJvd3NlciAgPSByZW1vdGUuQnJvd3NlcldpbmRvd1xud2luICAgICAgPSB3aW5kb3cud2luICAgPSByZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpXG53aW5JRCAgICA9IHdpbmRvdy53aW5JRCA9IHdpbi5pZFxuZmlsZUJyb3dzZXIgPSBudWxsXG5cbiMgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgMDAwICAgMDAwXG4jIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMFxuIyAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDBcbiMgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwXG4jIDAwICAgICAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMFxuXG53aW5NYWluID0gLT5cblxuICAgIGZpbGVCcm93c2VyID0gbmV3IEZpbGVCcm93c2VyICQgXCIjbWFpblwiXG4gICAgZmlsZUJyb3dzZXIubG9hZEl0ZW0gdHlwZTonZGlyJyBmaWxlOnNsYXNoLnJlc29sdmUgJ34nXG4gICAgXG4gICAgd2luLm9uICdyZXNpemUnIC0+IGZpbGVCcm93c2VyLnJlc2l6ZWQoKVxuXG4jIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcbiMgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMFxuIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMFxuIyAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwICAgICAgICAgMDAwMDAwMCAgIDAwMFxuXG5vbkNvbnRleHRNZW51ID0gKGV2ZW50KSAtPiBcbiAgICBcbiAgICByZXR1cm4gaWYgbm90IGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMgJ2NydW1iJ1xuICAgIFxuICAgIGZpbGVCcm93c2VyLmNvbHVtbnNbZXZlbnQudGFyZ2V0LmNvbHVtbkluZGV4XS5vbkNvbnRleHRNZW51IGV2ZW50LCB0cnVlXG4gICAgXG4kKFwiI2NydW1ic1wiKS5hZGRFdmVudExpc3RlbmVyICdjb250ZXh0bWVudScgb25Db250ZXh0TWVudVxuXG4jIDAwICAgICAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwMCAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwXG4jIDAwMCAwIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDBcbiMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuXG5vbk1lbnVBY3Rpb24gPSAobmFtZSwgYXJncykgLT5cblxuICAgIGtsb2cgJ21lbnVBY3Rpb24nIG5hbWVcbiAgICBcbiAgICBzd2l0Y2ggbmFtZVxuXG4gICAgICAgIHdoZW4gJ1RvZ2dsZSBFeHRlbnNpb25zJyB0aGVuIHJldHVybiB0b2dnbGVFeHRlbnNpb25zKClcbiAgICAgICAgd2hlbiAnSW5jcmVhc2UnICAgICAgICAgIHRoZW4gcmV0dXJuIGNoYW5nZUZvbnRTaXplICsxXG4gICAgICAgIHdoZW4gJ0RlY3JlYXNlJyAgICAgICAgICB0aGVuIHJldHVybiBjaGFuZ2VGb250U2l6ZSAtMVxuICAgICAgICB3aGVuICdSZXNldCcgICAgICAgICAgICAgdGhlbiByZXR1cm4gcmVzZXRGb250U2l6ZSgpXG4gICAgICAgIHdoZW4gJ0FkZCB0byBTaGVsZicgICAgICB0aGVuIHJldHVybiBhZGRUb1NoZWxmKClcbiAgICAgICAgd2hlbiAnUmVsb2FkIFdpbmRvdycgICAgIHRoZW4gcmV0dXJuIHJlbG9hZFdpbigpXG5cbiAgICBwb3N0LnRvTWFpbiAnbWVudUFjdGlvbicgbmFtZSwgYXJnc1xuXG5wb3N0Lm9uICdtZW51QWN0aW9uJyBvbk1lbnVBY3Rpb25cblxudG9nZ2xlRXh0ZW5zaW9ucyA9IC0+XG5cbiAgICBzdGF0ZUtleSA9IFwiYnJvd3NlcuKWuGhpZGVFeHRlbnNpb25zXCJcbiAgICBwcmVmcy5zZXQgc3RhdGVLZXksIG5vdCBwcmVmcy5nZXQgc3RhdGVLZXksIGZhbHNlXG4gICAgc2V0U3R5bGUgJy5icm93c2VyUm93IC5leHQnICAgJ2Rpc3BsYXknIHByZWZzLmdldChzdGF0ZUtleSkgYW5kICdub25lJyBvciAnaW5pdGlhbCdcbiAgICBzZXRTdHlsZSAnLmZpbGVJbmZvRmlsZSAuZXh0JyAnZGlzcGxheScgcHJlZnMuZ2V0KHN0YXRlS2V5KSBhbmQgJ25vbmUnIG9yICdpbml0aWFsJ1xuXG4jIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMFxuIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwIDAwMFxuIyAwMDAwMDAwICAgIDAwMDAwMDAgICAgIDAwMDAwXG4jIDAwMCAgMDAwICAgMDAwICAgICAgICAgIDAwMFxuIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDBcblxub25Db21ibyA9IChjb21ibywgaW5mbykgLT5cblxuICAgIHJldHVybiBpZiBub3QgY29tYm9cblxuICAgIHsgbW9kLCBrZXksIGNvbWJvLCBjaGFyLCBldmVudCB9ID0gaW5mb1xuXG4gICAgIyBzd2l0Y2ggY29tYm9cbiAgICAgICAgIyB3aGVuICdjb21tYW5kK3NoaWZ0Kz0nICAgIHRoZW4gcmV0dXJuIHN0b3BFdmVudCBldmVudCwgQGNoYW5nZVpvb20gKzFcbiAgICAgICAgIyB3aGVuICdjb21tYW5kK3NoaWZ0Ky0nICAgIHRoZW4gcmV0dXJuIHN0b3BFdmVudCBldmVudCwgQGNoYW5nZVpvb20gLTFcbiAgICAgICAgIyB3aGVuICdjb21tYW5kK3NoaWZ0KzAnICAgIHRoZW4gcmV0dXJuIHN0b3BFdmVudCBldmVudCwgQHJlc2V0Wm9vbSgpXG5cbnBvc3Qub24gJ2NvbWJvJyBvbkNvbWJvXG5cbndpbk1haW4oKVxuIl19
//# sourceURL=../coffee/window.coffee