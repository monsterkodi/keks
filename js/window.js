// koffee 1.4.0

/*
000   000  000  000   000  0000000     0000000   000   000
000 0 000  000  0000  000  000   000  000   000  000 0 000
000000000  000  000 0 000  000   000  000   000  000000000
000   000  000  000  0000  000   000  000   000  000   000
00     00  000  000   000  0000000     0000000   00     00
 */
var $, Browser, FileBrowser, _, args, changeFontSize, clamp, defaultFontSize, dialog, electron, fileBrowser, getFontSize, klog, kpos, onContextMenu, onMenuAction, onWheel, pkg, popup, post, prefs, ref, remote, resetFontSize, scheme, setFontSize, setStyle, slash, stopEvent, toggleExtensions, w, win, winID, winMain;

ref = require('kxk'), post = ref.post, args = ref.args, slash = ref.slash, prefs = ref.prefs, stopEvent = ref.stopEvent, setStyle = ref.setStyle, scheme = ref.scheme, popup = ref.popup, klog = ref.klog, clamp = ref.clamp, kpos = ref.kpos, win = ref.win, $ = ref.$, _ = ref._;

FileBrowser = require('./filebrowser');

w = new win({
    dir: __dirname,
    pkg: require('../package.json'),
    menu: '../coffee/menu.noon',
    icon: '../img/menu@2x.png',
    prefsSeperator: '▸',
    context: false,
    dragElem: $('#crumbs')
});

electron = require('electron');

pkg = require('../package.json');

remote = electron.remote;

dialog = remote.dialog;

Browser = remote.BrowserWindow;

win = window.win = remote.getCurrentWindow();

winID = window.winID = win.id;

fileBrowser = null;

winMain = function() {
    var active, load;
    fileBrowser = new FileBrowser($("#main"));
    if (args.folder[0]) {
        fileBrowser.browse(args.folder[0]);
    } else {
        if (load = prefs.get('load')) {
            klog('init load', load);
            if (load.last !== load.first) {
                active = load.last.slice(load.first.length);
                active = load.first + '/' + slash.split(active)[0];
            }
            fileBrowser.browse(load.first, {
                active: active,
                cb: function() {
                    return fileBrowser.navigateToFile(load.last);
                }
            });
        } else {
            fileBrowser.browse('~');
        }
    }
    return win.on('resize', function() {
        return fileBrowser.resized();
    });
};

onContextMenu = function(event) {
    if (!event.target.classList.contains('crumb')) {
        return;
    }
    return fileBrowser.columns[event.target.columnIndex].onContextMenu(event, true);
};

$("#crumbs").addEventListener('contextmenu', onContextMenu);

defaultFontSize = 18;

getFontSize = function() {
    return prefs.get('fontSize', defaultFontSize);
};

setFontSize = function(s) {
    if (!_.isFinite(s)) {
        s = getFontSize();
    }
    s = clamp(8, 44, s);
    prefs.set('fontSize', s);
    setStyle('#main', 'font-size', s + "px");
    return setStyle('.rowNameInput', 'font-size', s + "px");
};

changeFontSize = function(d) {
    var f, s;
    s = getFontSize();
    if (s >= 30) {
        f = 4;
    } else if (s >= 20) {
        f = 2;
    } else {
        f = 1;
    }
    return setFontSize(s + f * d);
};

resetFontSize = function() {
    prefs.set('fontSize', defaultFontSize);
    return setFontSize(defaultFontSize);
};

onWheel = function(event) {
    if (0 <= w.modifiers.indexOf('ctrl')) {
        return changeFontSize(-event.deltaY / 100);
    }
};

setFontSize(getFontSize());

window.document.addEventListener('wheel', onWheel);

onMenuAction = function(name, args) {
    switch (name) {
        case 'Toggle Extensions':
            return toggleExtensions();
        case 'Increase':
            return changeFontSize(+1);
        case 'Decrease':
            return changeFontSize(-1);
        case 'Reset':
            return resetFontSize();
        case 'Add to Shelf':
            return addToShelf();
        case 'Reload Window':
            return reloadWin();
    }
    klog('menuAction', name);
    return post.toMain('menuAction', name, args);
};

post.on('menuAction', onMenuAction);

post.on('load', function(info) {
    var load;
    load = prefs.get('load', {});
    if (info.column) {
        load.last = info.item.file;
    } else {
        load.first = info.item.file;
        load.last = info.item.file;
    }
    return prefs.set('load', load);
});

toggleExtensions = function() {
    var stateKey;
    stateKey = "browser▸hideExtensions";
    prefs.set(stateKey, !prefs.get(stateKey, false));
    setStyle('.browserRow .ext', 'display', prefs.get(stateKey) && 'none' || 'initial');
    return setStyle('.fileInfoFile .ext', 'display', prefs.get(stateKey) && 'none' || 'initial');
};

winMain();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2luZG93LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUFpRyxPQUFBLENBQVEsS0FBUixDQUFqRyxFQUFFLGVBQUYsRUFBUSxlQUFSLEVBQWMsaUJBQWQsRUFBcUIsaUJBQXJCLEVBQTRCLHlCQUE1QixFQUF1Qyx1QkFBdkMsRUFBaUQsbUJBQWpELEVBQXlELGlCQUF6RCxFQUFnRSxlQUFoRSxFQUFzRSxpQkFBdEUsRUFBNkUsZUFBN0UsRUFBbUYsYUFBbkYsRUFBd0YsU0FBeEYsRUFBMkY7O0FBRTNGLFdBQUEsR0FBYyxPQUFBLENBQVEsZUFBUjs7QUFFZCxDQUFBLEdBQUksSUFBSSxHQUFKLENBQ0E7SUFBQSxHQUFBLEVBQVEsU0FBUjtJQUNBLEdBQUEsRUFBUSxPQUFBLENBQVEsaUJBQVIsQ0FEUjtJQUVBLElBQUEsRUFBUSxxQkFGUjtJQUdBLElBQUEsRUFBUSxvQkFIUjtJQUlBLGNBQUEsRUFBZ0IsR0FKaEI7SUFLQSxPQUFBLEVBQVMsS0FMVDtJQU1BLFFBQUEsRUFBVSxDQUFBLENBQUUsU0FBRixDQU5WO0NBREE7O0FBU0osUUFBQSxHQUFXLE9BQUEsQ0FBUSxVQUFSOztBQUNYLEdBQUEsR0FBVyxPQUFBLENBQVEsaUJBQVI7O0FBRVgsTUFBQSxHQUFXLFFBQVEsQ0FBQzs7QUFDcEIsTUFBQSxHQUFXLE1BQU0sQ0FBQzs7QUFDbEIsT0FBQSxHQUFXLE1BQU0sQ0FBQzs7QUFDbEIsR0FBQSxHQUFXLE1BQU0sQ0FBQyxHQUFQLEdBQWUsTUFBTSxDQUFDLGdCQUFQLENBQUE7O0FBQzFCLEtBQUEsR0FBVyxNQUFNLENBQUMsS0FBUCxHQUFlLEdBQUcsQ0FBQzs7QUFDOUIsV0FBQSxHQUFjOztBQVFkLE9BQUEsR0FBVSxTQUFBO0FBRU4sUUFBQTtJQUFBLFdBQUEsR0FBYyxJQUFJLFdBQUosQ0FBZ0IsQ0FBQSxDQUFFLE9BQUYsQ0FBaEI7SUFF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O0lBQUEsUUFBQSxHQUFXO0lBQ1gsS0FBSyxDQUFDLEdBQU4sQ0FBVSxRQUFWLEVBQW9CLENBQUksS0FBSyxDQUFDLEdBQU4sQ0FBVSxRQUFWLEVBQW9CLEtBQXBCLENBQXhCO0lBQ0EsUUFBQSxDQUFTLGtCQUFULEVBQThCLFNBQTlCLEVBQXdDLEtBQUssQ0FBQyxHQUFOLENBQVUsUUFBVixDQUFBLElBQXdCLE1BQXhCLElBQWtDLFNBQTFFO1dBQ0EsUUFBQSxDQUFTLG9CQUFULEVBQThCLFNBQTlCLEVBQXdDLEtBQUssQ0FBQyxHQUFOLENBQVUsUUFBVixDQUFBLElBQXdCLE1BQXhCLElBQWtDLFNBQTFFO0FBTGU7O0FBcUJuQixPQUFBLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMDAgICAwMDBcbjAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDBcbjAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDBcbjAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcbjAwICAgICAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMCAgICAgMDBcbiMjI1xuXG57IHBvc3QsIGFyZ3MsIHNsYXNoLCBwcmVmcywgc3RvcEV2ZW50LCBzZXRTdHlsZSwgc2NoZW1lLCBwb3B1cCwga2xvZywgY2xhbXAsIGtwb3MsIHdpbiwgJCwgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5GaWxlQnJvd3NlciA9IHJlcXVpcmUgJy4vZmlsZWJyb3dzZXInXG4gIFxudyA9IG5ldyB3aW5cbiAgICBkaXI6ICAgIF9fZGlybmFtZVxuICAgIHBrZzogICAgcmVxdWlyZSAnLi4vcGFja2FnZS5qc29uJ1xuICAgIG1lbnU6ICAgJy4uL2NvZmZlZS9tZW51Lm5vb24nXG4gICAgaWNvbjogICAnLi4vaW1nL21lbnVAMngucG5nJ1xuICAgIHByZWZzU2VwZXJhdG9yOiAn4pa4J1xuICAgIGNvbnRleHQ6IGZhbHNlXG4gICAgZHJhZ0VsZW06ICQgJyNjcnVtYnMnXG4gICAgXG5lbGVjdHJvbiA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xucGtnICAgICAgPSByZXF1aXJlICcuLi9wYWNrYWdlLmpzb24nXG5cbnJlbW90ZSAgID0gZWxlY3Ryb24ucmVtb3RlXG5kaWFsb2cgICA9IHJlbW90ZS5kaWFsb2dcbkJyb3dzZXIgID0gcmVtb3RlLkJyb3dzZXJXaW5kb3dcbndpbiAgICAgID0gd2luZG93LndpbiAgID0gcmVtb3RlLmdldEN1cnJlbnRXaW5kb3coKVxud2luSUQgICAgPSB3aW5kb3cud2luSUQgPSB3aW4uaWRcbmZpbGVCcm93c2VyID0gbnVsbFxuXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgIDAwMCAgIDAwMFxuIyAwMDAgMCAwMDAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDBcbiMgMDAwMDAwMDAwICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgIDAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMFxuIyAwMCAgICAgMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDBcblxud2luTWFpbiA9IC0+XG5cbiAgICBmaWxlQnJvd3NlciA9IG5ldyBGaWxlQnJvd3NlciAkIFwiI21haW5cIlxuICAgIFxuICAgIGlmIGFyZ3MuZm9sZGVyWzBdXG4gICAgICAgIGZpbGVCcm93c2VyLmJyb3dzZSBhcmdzLmZvbGRlclswXVxuICAgIGVsc2VcbiAgICAgICAgaWYgbG9hZCA9IHByZWZzLmdldCAnbG9hZCdcbiAgICAgICAgICAgIGtsb2cgJ2luaXQgbG9hZCcgbG9hZFxuICAgICAgICAgICAgaWYgbG9hZC5sYXN0ICE9IGxvYWQuZmlyc3RcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSBsb2FkLmxhc3RbbG9hZC5maXJzdC5sZW5ndGguLl1cbiAgICAgICAgICAgICAgICBhY3RpdmUgPSBsb2FkLmZpcnN0ICsgJy8nICsgc2xhc2guc3BsaXQoYWN0aXZlKVswXVxuICAgICAgICAgICAgZmlsZUJyb3dzZXIuYnJvd3NlIGxvYWQuZmlyc3QsIGFjdGl2ZTphY3RpdmUsIGNiOiAtPlxuICAgICAgICAgICAgICAgIGZpbGVCcm93c2VyLm5hdmlnYXRlVG9GaWxlIGxvYWQubGFzdFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBmaWxlQnJvd3Nlci5icm93c2UgJ34nXG4gICAgXG4gICAgd2luLm9uICdyZXNpemUnIC0+IGZpbGVCcm93c2VyLnJlc2l6ZWQoKVxuXG4jIHdpbi5vbiAncmVhZHktdG8tc2hvdycgLT5cbiMgICAgIFxuICAgICMga2xvZyAncmVhZHktdG8tc2hvdycgZmlsZUJyb3dzZXIuY29sdW1uc1swXT9cbiAgICBcbiMgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwXG4jIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwXG4jIDAwMCAgICAgICAgIDAwMDAwMDAgICAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwXG5cbm9uQ29udGV4dE1lbnUgPSAoZXZlbnQpIC0+IFxuICAgIFxuICAgIHJldHVybiBpZiBub3QgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyAnY3J1bWInXG4gICAgXG4gICAgZmlsZUJyb3dzZXIuY29sdW1uc1tldmVudC50YXJnZXQuY29sdW1uSW5kZXhdLm9uQ29udGV4dE1lbnUgZXZlbnQsIHRydWVcbiAgICBcbiQoXCIjY3J1bWJzXCIpLmFkZEV2ZW50TGlzdGVuZXIgJ2NvbnRleHRtZW51JyBvbkNvbnRleHRNZW51XG5cblxuIyAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgICAgIDAwMDAwMDAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICAgICAgIDAwMCAgICAgICAwMDAgICAgIDAwMCAgIDAwMFxuIyAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgMCAwMDAgICAgIDAwMCAgICAgICAgMDAwMDAwMCAgIDAwMCAgICAwMDAgICAgMDAwMDAwMFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgICAgIDAwMCAgICAgICAgICAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwXG4jIDAwMCAgICAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAgICAwMDAwMDAwICAgMDAwICAwMDAwMDAwICAwMDAwMDAwMFxuXG5kZWZhdWx0Rm9udFNpemUgPSAxOFxuXG5nZXRGb250U2l6ZSA9IC0+IHByZWZzLmdldCAnZm9udFNpemUnIGRlZmF1bHRGb250U2l6ZVxuXG5zZXRGb250U2l6ZSA9IChzKSAtPlxuICAgICAgICBcbiAgICBzID0gZ2V0Rm9udFNpemUoKSBpZiBub3QgXy5pc0Zpbml0ZSBzXG4gICAgcyA9IGNsYW1wIDggNDQgc1xuXG4gICAgcHJlZnMuc2V0ICdmb250U2l6ZScgc1xuXG4gICAgc2V0U3R5bGUgJyNtYWluJyAgICAgICAgICdmb250LXNpemUnIFwiI3tzfXB4XCJcbiAgICBzZXRTdHlsZSAnLnJvd05hbWVJbnB1dCcgJ2ZvbnQtc2l6ZScgXCIje3N9cHhcIlxuXG5jaGFuZ2VGb250U2l6ZSA9IChkKSAtPlxuICAgIFxuICAgIHMgPSBnZXRGb250U2l6ZSgpXG4gICAgaWYgICAgICBzID49IDMwIHRoZW4gZiA9IDRcbiAgICBlbHNlIGlmIHMgPj0gMjAgdGhlbiBmID0gMlxuICAgIGVsc2UgICAgICAgICAgICAgICAgIGYgPSAxXG4gICAgICAgIFxuICAgIHNldEZvbnRTaXplIHMgKyBmKmRcblxucmVzZXRGb250U2l6ZSA9IC0+XG4gICAgXG4gICAgcHJlZnMuc2V0ICdmb250U2l6ZScgZGVmYXVsdEZvbnRTaXplXG4gICAgc2V0Rm9udFNpemUgZGVmYXVsdEZvbnRTaXplXG4gICAgIFxub25XaGVlbCA9IChldmVudCkgLT5cbiAgICBcbiAgICBpZiAwIDw9IHcubW9kaWZpZXJzLmluZGV4T2YgJ2N0cmwnXG4gICAgICAgIGNoYW5nZUZvbnRTaXplIC1ldmVudC5kZWx0YVkvMTAwXG4gIFxuc2V0Rm9udFNpemUgZ2V0Rm9udFNpemUoKVxud2luZG93LmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgJ3doZWVsJyBvbldoZWVsICAgIFxuXG4jIDAwICAgICAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwMCAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMFxuIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwXG4jIDAwMCAwIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDBcbiMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuXG5vbk1lbnVBY3Rpb24gPSAobmFtZSwgYXJncykgLT5cblxuICAgIHN3aXRjaCBuYW1lXG5cbiAgICAgICAgd2hlbiAnVG9nZ2xlIEV4dGVuc2lvbnMnIHRoZW4gcmV0dXJuIHRvZ2dsZUV4dGVuc2lvbnMoKVxuICAgICAgICB3aGVuICdJbmNyZWFzZScgICAgICAgICAgdGhlbiByZXR1cm4gY2hhbmdlRm9udFNpemUgKzFcbiAgICAgICAgd2hlbiAnRGVjcmVhc2UnICAgICAgICAgIHRoZW4gcmV0dXJuIGNoYW5nZUZvbnRTaXplIC0xXG4gICAgICAgIHdoZW4gJ1Jlc2V0JyAgICAgICAgICAgICB0aGVuIHJldHVybiByZXNldEZvbnRTaXplKClcbiAgICAgICAgd2hlbiAnQWRkIHRvIFNoZWxmJyAgICAgIHRoZW4gcmV0dXJuIGFkZFRvU2hlbGYoKVxuICAgICAgICB3aGVuICdSZWxvYWQgV2luZG93JyAgICAgdGhlbiByZXR1cm4gcmVsb2FkV2luKClcbiAgICAgICAgXG4gICAga2xvZyAnbWVudUFjdGlvbicgbmFtZVxuXG4gICAgcG9zdC50b01haW4gJ21lbnVBY3Rpb24nIG5hbWUsIGFyZ3NcblxucG9zdC5vbiAnbWVudUFjdGlvbicgb25NZW51QWN0aW9uXG5wb3N0Lm9uICdsb2FkJyAoaW5mbykgLT5cbiAgICBcbiAgICBsb2FkID0gcHJlZnMuZ2V0ICdsb2FkJyB7fVxuICAgIGlmIGluZm8uY29sdW1uXG4gICAgICAgIGxvYWQubGFzdCA9IGluZm8uaXRlbS5maWxlXG4gICAgZWxzZVxuICAgICAgICBsb2FkLmZpcnN0ID0gaW5mby5pdGVtLmZpbGVcbiAgICAgICAgbG9hZC5sYXN0ICA9IGluZm8uaXRlbS5maWxlXG4gICAgcHJlZnMuc2V0ICdsb2FkJyBsb2FkXG5cbnRvZ2dsZUV4dGVuc2lvbnMgPSAtPlxuXG4gICAgc3RhdGVLZXkgPSBcImJyb3dzZXLilrhoaWRlRXh0ZW5zaW9uc1wiXG4gICAgcHJlZnMuc2V0IHN0YXRlS2V5LCBub3QgcHJlZnMuZ2V0IHN0YXRlS2V5LCBmYWxzZVxuICAgIHNldFN0eWxlICcuYnJvd3NlclJvdyAuZXh0JyAgICdkaXNwbGF5JyBwcmVmcy5nZXQoc3RhdGVLZXkpIGFuZCAnbm9uZScgb3IgJ2luaXRpYWwnXG4gICAgc2V0U3R5bGUgJy5maWxlSW5mb0ZpbGUgLmV4dCcgJ2Rpc3BsYXknIHByZWZzLmdldChzdGF0ZUtleSkgYW5kICdub25lJyBvciAnaW5pdGlhbCdcblxuIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDBcbiMgMDAwICAwMDAgICAwMDAgICAgICAgIDAwMCAwMDBcbiMgMDAwMDAwMCAgICAwMDAwMDAwICAgICAwMDAwMFxuIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAwMDAwMCAgICAgMDAwXG5cbiMgb25Db21ibyA9IChjb21ibywgaW5mbykgLT5cblxuICAgICMgcmV0dXJuIGlmIG5vdCBjb21ib1xuXG4gICAgIyB7IG1vZCwga2V5LCBjb21ibywgY2hhciwgZXZlbnQgfSA9IGluZm9cblxuIyBwb3N0Lm9uICdjb21ibycgb25Db21ib1xuXG53aW5NYWluKClcbiJdfQ==
//# sourceURL=../coffee/window.coffee