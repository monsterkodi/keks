// koffee 1.4.0

/*
 0000000  000   000  000   000  000000000   0000000   000   000
000        000 000   0000  000     000     000   000   000 000
0000000     00000    000 0 000     000     000000000    00000
     000     000     000  0000     000     000   000   000 000
0000000      000     000   000     000     000   000  000   000
 */
var Balancer, Syntax, _, elem, klor, kstr, last, matchr, ref, valid,
    indexOf = [].indexOf;

ref = require('kxk'), matchr = ref.matchr, valid = ref.valid, elem = ref.elem, last = ref.last, kstr = ref.kstr, _ = ref._;

Balancer = require('./balancer');

klor = require('klor');

Syntax = (function() {
    function Syntax(name, getLine, getLines) {
        this.name = name;
        this.getLine = getLine;
        this.getLines = getLines;
        this.diss = [];
        this.colors = {};
        this.balancer = new Balancer(this, this.getLine);
    }

    Syntax.prototype.newDiss = function(li) {
        var diss;
        diss = this.balancer.dissForLine(li);
        return diss;
    };

    Syntax.prototype.getDiss = function(li) {
        if (this.diss[li] == null) {
            this.diss[li] = this.newDiss(li);
        }
        return this.diss[li];
    };

    Syntax.prototype.setDiss = function(li, dss) {
        this.diss[li] = dss;
        return dss;
    };

    Syntax.prototype.fillDiss = function(bot) {
        var i, li, ref1, results;
        results = [];
        for (li = i = 0, ref1 = bot; 0 <= ref1 ? i <= ref1 : i >= ref1; li = 0 <= ref1 ? ++i : --i) {
            results.push(this.getDiss(li));
        }
        return results;
    };

    Syntax.prototype.setLines = function(lines) {
        return this.balancer.setLines(lines);
    };

    Syntax.prototype.changed = function(changeInfo) {
        var ch, change, di, i, len, li, ref1, ref2, results;
        if (valid(changeInfo.changes)) {
            this.balancer.blocks = null;
        }
        ref1 = changeInfo.changes;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            change = ref1[i];
            ref2 = [change.doIndex, change.newIndex, change.change], di = ref2[0], li = ref2[1], ch = ref2[2];
            switch (ch) {
                case 'changed':
                    results.push(this.diss[di] = this.newDiss(di));
                    break;
                case 'deleted':
                    this.balancer.deleteLine(di);
                    results.push(this.diss.splice(di, 1));
                    break;
                case 'inserted':
                    this.balancer.insertLine(di);
                    results.push(this.diss.splice(di, 0, this.newDiss(di)));
                    break;
                default:
                    results.push(void 0);
            }
        }
        return results;
    };

    Syntax.prototype.setFileType = function(fileType) {
        this.name = fileType;
        return this.balancer.setFileType(fileType);
    };

    Syntax.prototype.clear = function() {
        this.diss = [];
        return this.balancer.clear();
    };

    Syntax.prototype.colorForClassnames = function(clss) {
        var color, computedStyle, div, opacity;
        if (this.colors[clss] == null) {
            div = elem({
                "class": clss
            });
            document.body.appendChild(div);
            computedStyle = window.getComputedStyle(div);
            color = computedStyle.color;
            opacity = computedStyle.opacity;
            if (opacity !== '1') {
                color = 'rgba(' + color.slice(4, color.length - 2) + ', ' + opacity + ')';
            }
            this.colors[clss] = color;
            div.remove();
        }
        return this.colors[clss];
    };

    Syntax.prototype.colorForStyle = function(styl) {
        var div;
        if (this.colors[styl] == null) {
            div = elem('div');
            div.style = styl;
            document.body.appendChild(div);
            this.colors[styl] = window.getComputedStyle(div).color;
            div.remove();
        }
        return this.colors[styl];
    };

    Syntax.prototype.schemeChanged = function() {
        return this.colors = {};
    };


    /*
     0000000  000000000   0000000   000000000  000   0000000
    000          000     000   000     000     000  000
    0000000      000     000000000     000     000  000
         000     000     000   000     000     000  000
    0000000      000     000   000     000     000   0000000
     */

    Syntax.matchrConfigs = {};

    Syntax.syntaxNames = [];

    Syntax.spanForTextAndSyntax = function(text, n) {
        var clrzd, clss, d, di, diss, i, j, l, ref1, ref2, ref3, sp, spc, style;
        l = "";
        diss = this.dissForTextAndSyntax(text, n);
        if (diss != null ? diss.length : void 0) {
            last = 0;
            for (di = i = 0, ref1 = diss.length; 0 <= ref1 ? i < ref1 : i > ref1; di = 0 <= ref1 ? ++i : --i) {
                d = diss[di];
                style = (d.styl != null) && d.styl.length && (" style=\"" + d.styl + "\"") || '';
                spc = '';
                for (sp = j = ref2 = last, ref3 = d.start; ref2 <= ref3 ? j < ref3 : j > ref3; sp = ref2 <= ref3 ? ++j : --j) {
                    spc += '&nbsp;';
                }
                last = d.start + d.match.length;
                clss = (d.clss != null) && d.clss.length && (" class=\"" + d.clss + "\"") || '';
                clrzd = "<span" + style + clss + ">" + spc + (kstr.encode(d.match)) + "</span>";
                l += clrzd;
            }
        }
        return l;
    };

    Syntax.rangesForTextAndSyntax = function(line, n) {
        return matchr.ranges(Syntax.matchrConfigs[n], line);
    };

    Syntax.dissForTextAndSyntax = function(text, n) {
        return klor.ranges(text, n);
    };

    Syntax.lineForDiss = function(dss) {
        var d, i, l, len;
        l = "";
        for (i = 0, len = dss.length; i < len; i++) {
            d = dss[i];
            l = _.padEnd(l, d.start);
            l += d.match;
        }
        return l;
    };

    Syntax.shebang = function(line) {
        var lastWord;
        if (line.startsWith("#!")) {
            lastWord = _.last(line.split(/[\s\/]/));
            switch (lastWord) {
                case 'python':
                    return 'py';
                case 'node':
                    return 'js';
                case 'bash':
                    return 'sh';
                default:
                    if (indexOf.call(this.syntaxNames, lastWord) >= 0) {
                        return lastWord;
                    }
            }
        }
        return 'txt';
    };

    Syntax.init = function() {
        return this.syntaxNames = this.syntaxNames.concat(klor.exts);
    };

    return Syntax;

})();

Syntax.init();

module.exports = Syntax;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ludGF4LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSwrREFBQTtJQUFBOztBQVFBLE1BQXlDLE9BQUEsQ0FBUSxLQUFSLENBQXpDLEVBQUUsbUJBQUYsRUFBVSxpQkFBVixFQUFpQixlQUFqQixFQUF1QixlQUF2QixFQUE2QixlQUE3QixFQUFtQzs7QUFFbkMsUUFBQSxHQUFXLE9BQUEsQ0FBUSxZQUFSOztBQUNYLElBQUEsR0FBVyxPQUFBLENBQVEsTUFBUjs7QUFFTDtJQUVDLGdCQUFDLElBQUQsRUFBUSxPQUFSLEVBQWtCLFFBQWxCO1FBQUMsSUFBQyxDQUFBLE9BQUQ7UUFBTyxJQUFDLENBQUEsVUFBRDtRQUFVLElBQUMsQ0FBQSxXQUFEO1FBRWpCLElBQUMsQ0FBQSxJQUFELEdBQVk7UUFDWixJQUFDLENBQUEsTUFBRCxHQUFZO1FBQ1osSUFBQyxDQUFBLFFBQUQsR0FBWSxJQUFJLFFBQUosQ0FBYSxJQUFiLEVBQWdCLElBQUMsQ0FBQSxPQUFqQjtJQUpiOztxQkFZSCxPQUFBLEdBQVMsU0FBQyxFQUFEO0FBRUwsWUFBQTtRQUFBLElBQUEsR0FBTyxJQUFDLENBQUEsUUFBUSxDQUFDLFdBQVYsQ0FBc0IsRUFBdEI7ZUFDUDtJQUhLOztxQkFLVCxPQUFBLEdBQVMsU0FBQyxFQUFEO1FBRUwsSUFBTyxxQkFBUDtZQUNJLElBQUMsQ0FBQSxJQUFLLENBQUEsRUFBQSxDQUFOLEdBQVksSUFBQyxDQUFBLE9BQUQsQ0FBUyxFQUFULEVBRGhCOztlQUdBLElBQUMsQ0FBQSxJQUFLLENBQUEsRUFBQTtJQUxEOztxQkFPVCxPQUFBLEdBQVMsU0FBQyxFQUFELEVBQUssR0FBTDtRQUVMLElBQUMsQ0FBQSxJQUFLLENBQUEsRUFBQSxDQUFOLEdBQVk7ZUFDWjtJQUhLOztxQkFLVCxRQUFBLEdBQVUsU0FBQyxHQUFEO0FBRU4sWUFBQTtBQUFBO2FBQVUscUZBQVY7eUJBQ0ksSUFBQyxDQUFBLE9BQUQsQ0FBUyxFQUFUO0FBREo7O0lBRk07O3FCQVdWLFFBQUEsR0FBVSxTQUFDLEtBQUQ7ZUFFTixJQUFDLENBQUEsUUFBUSxDQUFDLFFBQVYsQ0FBbUIsS0FBbkI7SUFGTTs7cUJBVVYsT0FBQSxHQUFTLFNBQUMsVUFBRDtBQUVMLFlBQUE7UUFBQSxJQUFHLEtBQUEsQ0FBTSxVQUFVLENBQUMsT0FBakIsQ0FBSDtZQUNJLElBQUMsQ0FBQSxRQUFRLENBQUMsTUFBVixHQUFtQixLQUR2Qjs7QUFHQTtBQUFBO2FBQUEsc0NBQUE7O1lBRUksT0FBYSxDQUFDLE1BQU0sQ0FBQyxPQUFSLEVBQWlCLE1BQU0sQ0FBQyxRQUF4QixFQUFrQyxNQUFNLENBQUMsTUFBekMsQ0FBYixFQUFDLFlBQUQsRUFBSSxZQUFKLEVBQU87QUFFUCxvQkFBTyxFQUFQO0FBQUEscUJBRVMsU0FGVDtpQ0FJUSxJQUFDLENBQUEsSUFBSyxDQUFBLEVBQUEsQ0FBTixHQUFZLElBQUMsQ0FBQSxPQUFELENBQVMsRUFBVDtBQUZYO0FBRlQscUJBTVMsU0FOVDtvQkFRUSxJQUFDLENBQUEsUUFBUSxDQUFDLFVBQVYsQ0FBcUIsRUFBckI7aUNBQ0EsSUFBQyxDQUFBLElBQUksQ0FBQyxNQUFOLENBQWEsRUFBYixFQUFpQixDQUFqQjtBQUhDO0FBTlQscUJBV1MsVUFYVDtvQkFhUSxJQUFDLENBQUEsUUFBUSxDQUFDLFVBQVYsQ0FBcUIsRUFBckI7aUNBQ0EsSUFBQyxDQUFBLElBQUksQ0FBQyxNQUFOLENBQWEsRUFBYixFQUFpQixDQUFqQixFQUFvQixJQUFDLENBQUEsT0FBRCxDQUFTLEVBQVQsQ0FBcEI7QUFIQztBQVhUOztBQUFBO0FBSko7O0lBTEs7O3FCQStCVCxXQUFBLEdBQWEsU0FBQyxRQUFEO1FBSVQsSUFBQyxDQUFBLElBQUQsR0FBUTtlQUNSLElBQUMsQ0FBQSxRQUFRLENBQUMsV0FBVixDQUFzQixRQUF0QjtJQUxTOztxQkFhYixLQUFBLEdBQU8sU0FBQTtRQUVILElBQUMsQ0FBQSxJQUFELEdBQVE7ZUFDUixJQUFDLENBQUEsUUFBUSxDQUFDLEtBQVYsQ0FBQTtJQUhHOztxQkFXUCxrQkFBQSxHQUFvQixTQUFDLElBQUQ7QUFFaEIsWUFBQTtRQUFBLElBQU8seUJBQVA7WUFFSSxHQUFBLEdBQU0sSUFBQSxDQUFLO2dCQUFBLENBQUEsS0FBQSxDQUFBLEVBQU8sSUFBUDthQUFMO1lBQ04sUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFkLENBQTBCLEdBQTFCO1lBQ0EsYUFBQSxHQUFnQixNQUFNLENBQUMsZ0JBQVAsQ0FBd0IsR0FBeEI7WUFDaEIsS0FBQSxHQUFRLGFBQWEsQ0FBQztZQUN0QixPQUFBLEdBQVUsYUFBYSxDQUFDO1lBQ3hCLElBQUcsT0FBQSxLQUFXLEdBQWQ7Z0JBQ0ksS0FBQSxHQUFRLE9BQUEsR0FBVSxLQUFLLENBQUMsS0FBTixDQUFZLENBQVosRUFBZSxLQUFLLENBQUMsTUFBTixHQUFhLENBQTVCLENBQVYsR0FBMkMsSUFBM0MsR0FBa0QsT0FBbEQsR0FBNEQsSUFEeEU7O1lBRUEsSUFBQyxDQUFBLE1BQU8sQ0FBQSxJQUFBLENBQVIsR0FBZ0I7WUFDaEIsR0FBRyxDQUFDLE1BQUosQ0FBQSxFQVZKOztBQVlBLGVBQU8sSUFBQyxDQUFBLE1BQU8sQ0FBQSxJQUFBO0lBZEM7O3FCQWdCcEIsYUFBQSxHQUFlLFNBQUMsSUFBRDtBQUVYLFlBQUE7UUFBQSxJQUFPLHlCQUFQO1lBQ0ksR0FBQSxHQUFNLElBQUEsQ0FBSyxLQUFMO1lBQ04sR0FBRyxDQUFDLEtBQUosR0FBWTtZQUNaLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBZCxDQUEwQixHQUExQjtZQUNBLElBQUMsQ0FBQSxNQUFPLENBQUEsSUFBQSxDQUFSLEdBQWdCLE1BQU0sQ0FBQyxnQkFBUCxDQUF3QixHQUF4QixDQUE0QixDQUFDO1lBQzdDLEdBQUcsQ0FBQyxNQUFKLENBQUEsRUFMSjs7QUFPQSxlQUFPLElBQUMsQ0FBQSxNQUFPLENBQUEsSUFBQTtJQVRKOztxQkFXZixhQUFBLEdBQWUsU0FBQTtlQUFHLElBQUMsQ0FBQSxNQUFELEdBQVU7SUFBYjs7O0FBRWY7Ozs7Ozs7O0lBUUEsTUFBQyxDQUFBLGFBQUQsR0FBaUI7O0lBQ2pCLE1BQUMsQ0FBQSxXQUFELEdBQWU7O0lBRWYsTUFBQyxDQUFBLG9CQUFELEdBQXVCLFNBQUMsSUFBRCxFQUFPLENBQVA7QUFFbkIsWUFBQTtRQUFBLENBQUEsR0FBSTtRQUNKLElBQUEsR0FBTyxJQUFDLENBQUEsb0JBQUQsQ0FBc0IsSUFBdEIsRUFBNEIsQ0FBNUI7UUFDUCxtQkFBRyxJQUFJLENBQUUsZUFBVDtZQUNJLElBQUEsR0FBTztBQUNQLGlCQUFVLDJGQUFWO2dCQUNJLENBQUEsR0FBSSxJQUFLLENBQUEsRUFBQTtnQkFDVCxLQUFBLEdBQVEsZ0JBQUEsSUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQW5CLElBQThCLENBQUEsV0FBQSxHQUFZLENBQUMsQ0FBQyxJQUFkLEdBQW1CLElBQW5CLENBQTlCLElBQXdEO2dCQUNoRSxHQUFBLEdBQU07QUFDTixxQkFBVSx1R0FBVjtvQkFDSSxHQUFBLElBQU87QUFEWDtnQkFFQSxJQUFBLEdBQVEsQ0FBQyxDQUFDLEtBQUYsR0FBVSxDQUFDLENBQUMsS0FBSyxDQUFDO2dCQUMxQixJQUFBLEdBQU8sZ0JBQUEsSUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQW5CLElBQThCLENBQUEsV0FBQSxHQUFZLENBQUMsQ0FBQyxJQUFkLEdBQW1CLElBQW5CLENBQTlCLElBQXdEO2dCQUMvRCxLQUFBLEdBQVEsT0FBQSxHQUFRLEtBQVIsR0FBZ0IsSUFBaEIsR0FBcUIsR0FBckIsR0FBd0IsR0FBeEIsR0FBNkIsQ0FBQyxJQUFJLENBQUMsTUFBTCxDQUFZLENBQUMsQ0FBQyxLQUFkLENBQUQsQ0FBN0IsR0FBa0Q7Z0JBQzFELENBQUEsSUFBSztBQVRULGFBRko7O2VBWUE7SUFoQm1COztJQWtCdkIsTUFBQyxDQUFBLHNCQUFELEdBQXlCLFNBQUMsSUFBRCxFQUFPLENBQVA7ZUFFckIsTUFBTSxDQUFDLE1BQVAsQ0FBYyxNQUFNLENBQUMsYUFBYyxDQUFBLENBQUEsQ0FBbkMsRUFBdUMsSUFBdkM7SUFGcUI7O0lBSXpCLE1BQUMsQ0FBQSxvQkFBRCxHQUF1QixTQUFDLElBQUQsRUFBTyxDQUFQO2VBRW5CLElBQUksQ0FBQyxNQUFMLENBQVksSUFBWixFQUFrQixDQUFsQjtJQUZtQjs7SUFJdkIsTUFBQyxDQUFBLFdBQUQsR0FBYyxTQUFDLEdBQUQ7QUFFVixZQUFBO1FBQUEsQ0FBQSxHQUFJO0FBQ0osYUFBQSxxQ0FBQTs7WUFDSSxDQUFBLEdBQUksQ0FBQyxDQUFDLE1BQUYsQ0FBUyxDQUFULEVBQVksQ0FBQyxDQUFDLEtBQWQ7WUFDSixDQUFBLElBQUssQ0FBQyxDQUFDO0FBRlg7ZUFHQTtJQU5VOztJQWNkLE1BQUMsQ0FBQSxPQUFELEdBQVUsU0FBQyxJQUFEO0FBRU4sWUFBQTtRQUFBLElBQUcsSUFBSSxDQUFDLFVBQUwsQ0FBZ0IsSUFBaEIsQ0FBSDtZQUNJLFFBQUEsR0FBVyxDQUFDLENBQUMsSUFBRixDQUFPLElBQUksQ0FBQyxLQUFMLENBQVcsUUFBWCxDQUFQO0FBQ1gsb0JBQU8sUUFBUDtBQUFBLHFCQUNTLFFBRFQ7QUFDdUIsMkJBQU87QUFEOUIscUJBRVMsTUFGVDtBQUV1QiwyQkFBTztBQUY5QixxQkFHUyxNQUhUO0FBR3VCLDJCQUFPO0FBSDlCO29CQUtRLElBQUcsYUFBWSxJQUFDLENBQUEsV0FBYixFQUFBLFFBQUEsTUFBSDtBQUNJLCtCQUFPLFNBRFg7O0FBTFIsYUFGSjs7ZUFTQTtJQVhNOztJQW1CVixNQUFDLENBQUEsSUFBRCxHQUFPLFNBQUE7ZUF5QkgsSUFBQyxDQUFBLFdBQUQsR0FBZSxJQUFDLENBQUEsV0FBVyxDQUFDLE1BQWIsQ0FBb0IsSUFBSSxDQUFDLElBQXpCO0lBekJaOzs7Ozs7QUEyQlgsTUFBTSxDQUFDLElBQVAsQ0FBQTs7QUFDQSxNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4wMDAgICAgICAgIDAwMCAwMDAgICAwMDAwICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgMDAwIDAwMFxuMDAwMDAwMCAgICAgMDAwMDAgICAgMDAwIDAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwMCAgICAwMDAwMFxuICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgIDAwMCAwMDBcbjAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuIyMjXG5cbnsgbWF0Y2hyLCB2YWxpZCwgZWxlbSwgbGFzdCwga3N0ciwgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5CYWxhbmNlciA9IHJlcXVpcmUgJy4vYmFsYW5jZXInXG5rbG9yICAgICA9IHJlcXVpcmUgJ2tsb3InXG5cbmNsYXNzIFN5bnRheFxuICAgIFxuICAgIEA6IChAbmFtZSwgQGdldExpbmUsIEBnZXRMaW5lcykgLT5cblxuICAgICAgICBAZGlzcyAgICAgPSBbXVxuICAgICAgICBAY29sb3JzICAgPSB7fVxuICAgICAgICBAYmFsYW5jZXIgPSBuZXcgQmFsYW5jZXIgQCwgQGdldExpbmVcblxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMFxuICAgICMgMDAwMDAwMCAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwXG5cbiAgICBuZXdEaXNzOiAobGkpIC0+XG5cbiAgICAgICAgZGlzcyA9IEBiYWxhbmNlci5kaXNzRm9yTGluZSBsaVxuICAgICAgICBkaXNzXG5cbiAgICBnZXREaXNzOiAobGkpIC0+XG5cbiAgICAgICAgaWYgbm90IEBkaXNzW2xpXT9cbiAgICAgICAgICAgIEBkaXNzW2xpXSA9IEBuZXdEaXNzIGxpXG5cbiAgICAgICAgQGRpc3NbbGldXG5cbiAgICBzZXREaXNzOiAobGksIGRzcykgLT5cblxuICAgICAgICBAZGlzc1tsaV0gPSBkc3NcbiAgICAgICAgZHNzXG5cbiAgICBmaWxsRGlzczogKGJvdCkgLT5cblxuICAgICAgICBmb3IgbGkgaW4gWzAuLmJvdF1cbiAgICAgICAgICAgIEBnZXREaXNzIGxpXG5cbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgICAgICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICBcbiAgICBcbiAgICBzZXRMaW5lczogKGxpbmVzKSAtPlxuICAgICAgICBcbiAgICAgICAgQGJhbGFuY2VyLnNldExpbmVzIGxpbmVzXG4gICAgICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMFxuXG4gICAgY2hhbmdlZDogKGNoYW5nZUluZm8pIC0+XG5cbiAgICAgICAgaWYgdmFsaWQgY2hhbmdlSW5mby5jaGFuZ2VzXG4gICAgICAgICAgICBAYmFsYW5jZXIuYmxvY2tzID0gbnVsbFxuICAgICAgICBcbiAgICAgICAgZm9yIGNoYW5nZSBpbiBjaGFuZ2VJbmZvLmNoYW5nZXNcblxuICAgICAgICAgICAgW2RpLGxpLGNoXSA9IFtjaGFuZ2UuZG9JbmRleCwgY2hhbmdlLm5ld0luZGV4LCBjaGFuZ2UuY2hhbmdlXVxuXG4gICAgICAgICAgICBzd2l0Y2ggY2hcblxuICAgICAgICAgICAgICAgIHdoZW4gJ2NoYW5nZWQnXG5cbiAgICAgICAgICAgICAgICAgICAgQGRpc3NbZGldID0gQG5ld0Rpc3MgZGlcblxuICAgICAgICAgICAgICAgIHdoZW4gJ2RlbGV0ZWQnXG5cbiAgICAgICAgICAgICAgICAgICAgQGJhbGFuY2VyLmRlbGV0ZUxpbmUgZGlcbiAgICAgICAgICAgICAgICAgICAgQGRpc3Muc3BsaWNlIGRpLCAxXG5cbiAgICAgICAgICAgICAgICB3aGVuICdpbnNlcnRlZCdcblxuICAgICAgICAgICAgICAgICAgICBAYmFsYW5jZXIuaW5zZXJ0TGluZSBkaVxuICAgICAgICAgICAgICAgICAgICBAZGlzcy5zcGxpY2UgZGksIDAsIEBuZXdEaXNzIGRpXG5cbiAgICAjIDAwMDAwMDAwICAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgIDAwMCAwMDAgICAwMDAgICAwMDAgIDAwMFxuICAgICMgMDAwMDAwICAgIDAwMCAgMDAwICAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgICAwMDAwMCAgICAwMDAwMDAwMCAgIDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDAwMDAwMFxuXG4gICAgc2V0RmlsZVR5cGU6IChmaWxlVHlwZSkgLT5cblxuICAgICAgICAjIGtsb2cgJ1N5bnRheC5zZXRGaWxlVHlwZScsIGZpbGVUeXBlXG4gICAgICAgIFxuICAgICAgICBAbmFtZSA9IGZpbGVUeXBlXG4gICAgICAgIEBiYWxhbmNlci5zZXRGaWxlVHlwZSBmaWxlVHlwZVxuICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcblxuICAgIGNsZWFyOiAtPlxuXG4gICAgICAgIEBkaXNzID0gW11cbiAgICAgICAgQGJhbGFuY2VyLmNsZWFyKClcblxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwXG5cbiAgICBjb2xvckZvckNsYXNzbmFtZXM6IChjbHNzKSAtPlxuXG4gICAgICAgIGlmIG5vdCBAY29sb3JzW2Nsc3NdP1xuXG4gICAgICAgICAgICBkaXYgPSBlbGVtIGNsYXNzOiBjbHNzXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkIGRpdlxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlIGRpdlxuICAgICAgICAgICAgY29sb3IgPSBjb21wdXRlZFN0eWxlLmNvbG9yXG4gICAgICAgICAgICBvcGFjaXR5ID0gY29tcHV0ZWRTdHlsZS5vcGFjaXR5XG4gICAgICAgICAgICBpZiBvcGFjaXR5ICE9ICcxJ1xuICAgICAgICAgICAgICAgIGNvbG9yID0gJ3JnYmEoJyArIGNvbG9yLnNsaWNlKDQsIGNvbG9yLmxlbmd0aC0yKSArICcsICcgKyBvcGFjaXR5ICsgJyknXG4gICAgICAgICAgICBAY29sb3JzW2Nsc3NdID0gY29sb3JcbiAgICAgICAgICAgIGRpdi5yZW1vdmUoKVxuXG4gICAgICAgIHJldHVybiBAY29sb3JzW2Nsc3NdXG5cbiAgICBjb2xvckZvclN0eWxlOiAoc3R5bCkgLT5cblxuICAgICAgICBpZiBub3QgQGNvbG9yc1tzdHlsXT9cbiAgICAgICAgICAgIGRpdiA9IGVsZW0gJ2RpdidcbiAgICAgICAgICAgIGRpdi5zdHlsZSA9IHN0eWxcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQgZGl2XG4gICAgICAgICAgICBAY29sb3JzW3N0eWxdID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2KS5jb2xvclxuICAgICAgICAgICAgZGl2LnJlbW92ZSgpXG5cbiAgICAgICAgcmV0dXJuIEBjb2xvcnNbc3R5bF1cblxuICAgIHNjaGVtZUNoYW5nZWQ6IC0+IEBjb2xvcnMgPSB7fVxuXG4gICAgIyMjXG4gICAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDBcbiAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAwMDBcbiAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwICAwMDBcbiAgICAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAwMDBcbiAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwMDAwMFxuICAgICMjI1xuXG4gICAgQG1hdGNockNvbmZpZ3MgPSB7fVxuICAgIEBzeW50YXhOYW1lcyA9IFtdXG5cbiAgICBAc3BhbkZvclRleHRBbmRTeW50YXg6ICh0ZXh0LCBuKSAtPlxuXG4gICAgICAgIGwgPSBcIlwiXG4gICAgICAgIGRpc3MgPSBAZGlzc0ZvclRleHRBbmRTeW50YXggdGV4dCwgblxuICAgICAgICBpZiBkaXNzPy5sZW5ndGhcbiAgICAgICAgICAgIGxhc3QgPSAwXG4gICAgICAgICAgICBmb3IgZGkgaW4gWzAuLi5kaXNzLmxlbmd0aF1cbiAgICAgICAgICAgICAgICBkID0gZGlzc1tkaV1cbiAgICAgICAgICAgICAgICBzdHlsZSA9IGQuc3R5bD8gYW5kIGQuc3R5bC5sZW5ndGggYW5kIFwiIHN0eWxlPVxcXCIje2Quc3R5bH1cXFwiXCIgb3IgJydcbiAgICAgICAgICAgICAgICBzcGMgPSAnJ1xuICAgICAgICAgICAgICAgIGZvciBzcCBpbiBbbGFzdC4uLmQuc3RhcnRdXG4gICAgICAgICAgICAgICAgICAgIHNwYyArPSAnJm5ic3A7J1xuICAgICAgICAgICAgICAgIGxhc3QgID0gZC5zdGFydCArIGQubWF0Y2gubGVuZ3RoXG4gICAgICAgICAgICAgICAgY2xzcyA9IGQuY2xzcz8gYW5kIGQuY2xzcy5sZW5ndGggYW5kIFwiIGNsYXNzPVxcXCIje2QuY2xzc31cXFwiXCIgb3IgJydcbiAgICAgICAgICAgICAgICBjbHJ6ZCA9IFwiPHNwYW4je3N0eWxlfSN7Y2xzc30+I3tzcGN9I3trc3RyLmVuY29kZSBkLm1hdGNofTwvc3Bhbj5cIlxuICAgICAgICAgICAgICAgIGwgKz0gY2xyemRcbiAgICAgICAgbFxuXG4gICAgQHJhbmdlc0ZvclRleHRBbmRTeW50YXg6IChsaW5lLCBuKSAtPlxuXG4gICAgICAgIG1hdGNoci5yYW5nZXMgU3ludGF4Lm1hdGNockNvbmZpZ3Nbbl0sIGxpbmVcblxuICAgIEBkaXNzRm9yVGV4dEFuZFN5bnRheDogKHRleHQsIG4pIC0+XG5cbiAgICAgICAga2xvci5yYW5nZXMgdGV4dCwgblxuXG4gICAgQGxpbmVGb3JEaXNzOiAoZHNzKSAtPlxuXG4gICAgICAgIGwgPSBcIlwiXG4gICAgICAgIGZvciBkIGluIGRzc1xuICAgICAgICAgICAgbCA9IF8ucGFkRW5kIGwsIGQuc3RhcnRcbiAgICAgICAgICAgIGwgKz0gZC5tYXRjaFxuICAgICAgICBsXG5cbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgMCAwMDAgIDAwMCAgMDAwMFxuICAgICMgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwXG5cbiAgICBAc2hlYmFuZzogKGxpbmUpIC0+XG5cbiAgICAgICAgaWYgbGluZS5zdGFydHNXaXRoIFwiIyFcIlxuICAgICAgICAgICAgbGFzdFdvcmQgPSBfLmxhc3QgbGluZS5zcGxpdCAvW1xcc1xcL10vXG4gICAgICAgICAgICBzd2l0Y2ggbGFzdFdvcmRcbiAgICAgICAgICAgICAgICB3aGVuICdweXRob24nIHRoZW4gcmV0dXJuICdweSdcbiAgICAgICAgICAgICAgICB3aGVuICdub2RlJyAgIHRoZW4gcmV0dXJuICdqcydcbiAgICAgICAgICAgICAgICB3aGVuICdiYXNoJyAgIHRoZW4gcmV0dXJuICdzaCdcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGlmIGxhc3RXb3JkIGluIEBzeW50YXhOYW1lc1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxhc3RXb3JkXG4gICAgICAgICd0eHQnXG5cbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgMDAwXG4gICAgIyAwMDAgIDAwMCAwIDAwMCAgMDAwICAgICAwMDBcbiAgICAjIDAwMCAgMDAwICAwMDAwICAwMDAgICAgIDAwMFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgMDAwXG5cbiAgICBAaW5pdDogLT5cblxuICAgICAgICAjIHN5bnRheERpciA9IFwiI3tfX2Rpcm5hbWV9Ly4uLy4uL3N5bnRheC9cIlxuXG4gICAgICAgICMgZm9yIHN5bnRheEZpbGUgaW4gZnMucmVhZGRpclN5bmMgc3ludGF4RGlyXG5cbiAgICAgICAgICAgICMgc3ludGF4TmFtZSA9IHNsYXNoLmJhc2VuYW1lIHN5bnRheEZpbGUsICcubm9vbidcbiAgICAgICAgICAgICMgcGF0dGVybnMgPSBub29uLmxvYWQgc2xhc2guam9pbiBzeW50YXhEaXIsIHN5bnRheEZpbGVcblxuICAgICAgICAgICAgIyBwYXR0ZXJuc1snXFxcXHcrJ10gICAgICAgPSAndGV4dCcgICAjIHRoaXMgZW5zdXJlcyB0aGF0IGFsbCAuLi5cbiAgICAgICAgICAgICMgcGF0dGVybnNbJ1teXFxcXHdcXFxcc10rJ10gPSAnc3ludGF4JyAjIG5vbi1zcGFjZSBjaGFyYWN0ZXJzIG1hdGNoXG5cbiAgICAgICAgICAgICMgaWYgcGF0dGVybnMua28/LmV4dG5hbWVzP1xuICAgICAgICAgICAgICAgICMgZXh0bmFtZXMgPSBwYXR0ZXJucy5rby5leHRuYW1lc1xuICAgICAgICAgICAgICAgICMgZGVsZXRlIHBhdHRlcm5zLmtvXG5cbiAgICAgICAgICAgICAgICAjIGNvbmZpZyA9IG1hdGNoci5jb25maWcgcGF0dGVybnNcbiAgICAgICAgICAgICAgICAjIGZvciBzeW50YXhOYW1lIGluIGV4dG5hbWVzXG4gICAgICAgICAgICAgICAgICAgICMgQHN5bnRheE5hbWVzLnB1c2ggc3ludGF4TmFtZVxuICAgICAgICAgICAgICAgICAgICAjIEBtYXRjaHJDb25maWdzW3N5bnRheE5hbWVdID0gY29uZmlnXG4gICAgICAgICAgICAjIGVsc2VcbiAgICAgICAgICAgICAgICAjIEBzeW50YXhOYW1lcy5wdXNoIHN5bnRheE5hbWVcbiAgICAgICAgICAgICAgICAjIEBtYXRjaHJDb25maWdzW3N5bnRheE5hbWVdID0gbWF0Y2hyLmNvbmZpZyBwYXR0ZXJuc1xuXG4gICAgICAgICMga2xvci5pbml0KClcbiAgICAgICAgQHN5bnRheE5hbWVzID0gQHN5bnRheE5hbWVzLmNvbmNhdCBrbG9yLmV4dHNcblxuU3ludGF4LmluaXQoKVxubW9kdWxlLmV4cG9ydHMgPSBTeW50YXhcbiJdfQ==
//# sourceURL=../../coffee/editor/syntax.coffee