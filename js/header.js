// koffee 1.4.0

/*
000   000  00000000   0000000   0000000    00000000  00000000   
000   000  000       000   000  000   000  000       000   000  
000000000  0000000   000000000  000   000  0000000   0000000    
000   000  000       000   000  000   000  000       000   000  
000   000  00000000  000   000  0000000    00000000  000   000
 */
var $, File, Header, elem, klog, kpos, ref, slash,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), slash = ref.slash, elem = ref.elem, kpos = ref.kpos, klog = ref.klog, $ = ref.$;

File = require('./tools/file');

Header = (function() {
    function Header(browser) {
        this.browser = browser;
        this.onMouseUp = bind(this.onMouseUp, this);
        this.onMouseDown = bind(this.onMouseDown, this);
        this.elem = elem({
            id: 'header'
        });
        this.elem.addEventListener('mousedown', this.onMouseDown);
        this.elem.addEventListener('mouseup', this.onMouseUp);
        $('crumbs').appendChild(this.elem);
        this.crumb = elem({
            "class": 'crumb'
        });
        this.elem.appendChild(this.crumb);
    }

    Header.prototype.del = function() {
        return this.elem.remove();
    };

    Header.prototype.onMouseDown = function(event) {
        return this.downPos = kpos(window.win.getBounds());
    };

    Header.prototype.onMouseUp = function(event) {
        var br, root, upPos;
        if (!this.downPos) {
            return;
        }
        upPos = kpos(window.win.getBounds());
        if (upPos.to(this.downPos).length() > 0) {
            delete this.downPos;
            return;
        }
        if (event.target.id) {
            this.browser.browse(event.target.id);
        } else {
            root = this.crumb.firstChild;
            br = root.getBoundingClientRect();
            if (kpos(event).x < br.left) {
                this.browser.browse(root.id);
            } else {
                this.browser.browse(this.file);
            }
        }
        return delete this.downPos;
    };

    Header.prototype.setFile = function(file) {
        this.file = file;
        return this.crumb.innerHTML = File.crumbSpan(slash.tilde(this.file));
    };

    return Header;

})();

module.exports = Header;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSw2Q0FBQTtJQUFBOztBQVFBLE1BQWlDLE9BQUEsQ0FBUSxLQUFSLENBQWpDLEVBQUUsaUJBQUYsRUFBUyxlQUFULEVBQWUsZUFBZixFQUFxQixlQUFyQixFQUEyQjs7QUFFM0IsSUFBQSxHQUFPLE9BQUEsQ0FBUSxjQUFSOztBQUVEO0lBRUMsZ0JBQUMsT0FBRDtRQUFDLElBQUMsQ0FBQSxVQUFEOzs7UUFFQSxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUEsQ0FBSztZQUFBLEVBQUEsRUFBRyxRQUFIO1NBQUw7UUFDUixJQUFDLENBQUEsSUFBSSxDQUFDLGdCQUFOLENBQXVCLFdBQXZCLEVBQW1DLElBQUMsQ0FBQSxXQUFwQztRQUNBLElBQUMsQ0FBQSxJQUFJLENBQUMsZ0JBQU4sQ0FBdUIsU0FBdkIsRUFBbUMsSUFBQyxDQUFBLFNBQXBDO1FBQ0EsQ0FBQSxDQUFFLFFBQUYsQ0FBVyxDQUFDLFdBQVosQ0FBd0IsSUFBQyxDQUFBLElBQXpCO1FBRUEsSUFBQyxDQUFBLEtBQUQsR0FBUyxJQUFBLENBQUs7WUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFNLE9BQU47U0FBTDtRQUNULElBQUMsQ0FBQSxJQUFJLENBQUMsV0FBTixDQUFrQixJQUFDLENBQUEsS0FBbkI7SUFSRDs7cUJBVUgsR0FBQSxHQUFLLFNBQUE7ZUFBRyxJQUFDLENBQUEsSUFBSSxDQUFDLE1BQU4sQ0FBQTtJQUFIOztxQkFFTCxXQUFBLEdBQWEsU0FBQyxLQUFEO2VBRVQsSUFBQyxDQUFBLE9BQUQsR0FBVyxJQUFBLENBQUssTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFYLENBQUEsQ0FBTDtJQUZGOztxQkFJYixTQUFBLEdBQVcsU0FBQyxLQUFEO0FBRVAsWUFBQTtRQUFBLElBQVUsQ0FBSSxJQUFDLENBQUEsT0FBZjtBQUFBLG1CQUFBOztRQUVBLEtBQUEsR0FBUSxJQUFBLENBQUssTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFYLENBQUEsQ0FBTDtRQUVSLElBQUcsS0FBSyxDQUFDLEVBQU4sQ0FBUyxJQUFDLENBQUEsT0FBVixDQUFrQixDQUFDLE1BQW5CLENBQUEsQ0FBQSxHQUE4QixDQUFqQztZQUNJLE9BQU8sSUFBQyxDQUFBO0FBQ1IsbUJBRko7O1FBSUEsSUFBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQWhCO1lBQ0ksSUFBQyxDQUFBLE9BQU8sQ0FBQyxNQUFULENBQWdCLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBN0IsRUFESjtTQUFBLE1BQUE7WUFHSSxJQUFBLEdBQU8sSUFBQyxDQUFBLEtBQUssQ0FBQztZQUNkLEVBQUEsR0FBSyxJQUFJLENBQUMscUJBQUwsQ0FBQTtZQUNMLElBQUcsSUFBQSxDQUFLLEtBQUwsQ0FBVyxDQUFDLENBQVosR0FBZ0IsRUFBRSxDQUFDLElBQXRCO2dCQUNJLElBQUMsQ0FBQSxPQUFPLENBQUMsTUFBVCxDQUFnQixJQUFJLENBQUMsRUFBckIsRUFESjthQUFBLE1BQUE7Z0JBR0ksSUFBQyxDQUFBLE9BQU8sQ0FBQyxNQUFULENBQWdCLElBQUMsQ0FBQSxJQUFqQixFQUhKO2FBTEo7O2VBVUEsT0FBTyxJQUFDLENBQUE7SUFwQkQ7O3FCQXNCWCxPQUFBLEdBQVMsU0FBQyxJQUFEO1FBQUMsSUFBQyxDQUFBLE9BQUQ7ZUFFTixJQUFDLENBQUEsS0FBSyxDQUFDLFNBQVAsR0FBbUIsSUFBSSxDQUFDLFNBQUwsQ0FBZSxLQUFLLENBQUMsS0FBTixDQUFZLElBQUMsQ0FBQSxJQUFiLENBQWY7SUFGZDs7Ozs7O0FBSWIsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwMCAgMDAwMDAwMDAgICBcbjAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbjAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgICBcbjAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICBcbjAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwMCAgMDAwICAgMDAwICBcbiMjI1xuXG57IHNsYXNoLCBlbGVtLCBrcG9zLCBrbG9nLCAkIH0gPSByZXF1aXJlICdreGsnXG5cbkZpbGUgPSByZXF1aXJlICcuL3Rvb2xzL2ZpbGUnXG5cbmNsYXNzIEhlYWRlclxuXG4gICAgQDogKEBicm93c2VyKSAtPlxuICAgICAgICBcbiAgICAgICAgQGVsZW0gPSBlbGVtIGlkOidoZWFkZXInXG4gICAgICAgIEBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgJ21vdXNlZG93bicgQG9uTW91c2VEb3duXG4gICAgICAgIEBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgJ21vdXNldXAnICAgQG9uTW91c2VVcFxuICAgICAgICAkKCdjcnVtYnMnKS5hcHBlbmRDaGlsZCBAZWxlbVxuICAgICAgICBcbiAgICAgICAgQGNydW1iID0gZWxlbSBjbGFzczonY3J1bWInXG4gICAgICAgIEBlbGVtLmFwcGVuZENoaWxkIEBjcnVtYlxuXG4gICAgZGVsOiAtPiBAZWxlbS5yZW1vdmUoKVxuICAgIFxuICAgIG9uTW91c2VEb3duOiAoZXZlbnQpID0+XG4gICAgICAgIFxuICAgICAgICBAZG93blBvcyA9IGtwb3Mgd2luZG93Lndpbi5nZXRCb3VuZHMoKVxuICAgICAgICAgICAgXG4gICAgb25Nb3VzZVVwOiAoZXZlbnQpID0+XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgbm90IEBkb3duUG9zXG4gICAgICAgIFxuICAgICAgICB1cFBvcyA9IGtwb3Mgd2luZG93Lndpbi5nZXRCb3VuZHMoKVxuICAgICAgICBcbiAgICAgICAgaWYgdXBQb3MudG8oQGRvd25Qb3MpLmxlbmd0aCgpID4gMFxuICAgICAgICAgICAgZGVsZXRlIEBkb3duUG9zXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgXG4gICAgICAgIGlmIGV2ZW50LnRhcmdldC5pZFxuICAgICAgICAgICAgQGJyb3dzZXIuYnJvd3NlIGV2ZW50LnRhcmdldC5pZFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICByb290ID0gQGNydW1iLmZpcnN0Q2hpbGRcbiAgICAgICAgICAgIGJyID0gcm9vdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgICAgICAgaWYga3BvcyhldmVudCkueCA8IGJyLmxlZnRcbiAgICAgICAgICAgICAgICBAYnJvd3Nlci5icm93c2Ugcm9vdC5pZFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIEBicm93c2VyLmJyb3dzZSBAZmlsZVxuICAgICAgICAgICAgXG4gICAgICAgIGRlbGV0ZSBAZG93blBvc1xuICAgICAgICBcbiAgICBzZXRGaWxlOiAoQGZpbGUpIC0+XG4gICAgICAgIFxuICAgICAgICBAY3J1bWIuaW5uZXJIVE1MID0gRmlsZS5jcnVtYlNwYW4gc2xhc2gudGlsZGUgQGZpbGVcbiAgICAgICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBIZWFkZXJcbiJdfQ==
//# sourceURL=../coffee/header.coffee