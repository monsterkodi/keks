// koffee 1.4.0

/*
00000000    0000000   000   000
000   000  000   000  000 0 000
0000000    000   000  000000000
000   000  000   000  000   000
000   000   0000000   00     00
 */
var $, File, Row, _, app, clamp, drag, electron, elem, empty, fs, kerror, keyinfo, klog, post, ref, slash, stopEvent, valid,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), elem = ref.elem, keyinfo = ref.keyinfo, drag = ref.drag, clamp = ref.clamp, stopEvent = ref.stopEvent, valid = ref.valid, empty = ref.empty, post = ref.post, slash = ref.slash, klog = ref.klog, kerror = ref.kerror, fs = ref.fs, $ = ref.$, _ = ref._;

electron = require('electron');

File = require('./tools/file');

app = electron.remote.app;

Row = (function() {
    function Row(column, item) {
        var html, ref1, ref2, text;
        this.column = column;
        this.item = item;
        this.onDrop = bind(this.onDrop, this);
        this.onDragOver = bind(this.onDragOver, this);
        this.onDragStart = bind(this.onDragStart, this);
        this.onMouseDown = bind(this.onMouseDown, this);
        this.rename = bind(this.rename, this);
        this.onNameChange = bind(this.onNameChange, this);
        this.onNameFocusOut = bind(this.onNameFocusOut, this);
        this.onNameKeyDown = bind(this.onNameKeyDown, this);
        this.editName = bind(this.editName, this);
        this.activate = bind(this.activate, this);
        this.browser = this.column.browser;
        text = (ref1 = this.item.text) != null ? ref1 : this.item.name;
        if (empty(text) || empty(text.trim())) {
            html = '<span> </span>';
        } else {
            html = File.span(text);
        }
        this.div = elem({
            "class": 'browserRow',
            html: html,
            draggable: true
        });
        this.div.classList.add(this.item.type);
        this.column.table.appendChild(this.div);
        if (((ref2 = this.item.type) === 'file' || ref2 === 'dir') || this.item.icon) {
            this.setIcon();
        }
        this.div.onmousedown = this.onMouseDown;
        this.div.ondragstart = this.onDragStart;
        this.div.ondragover = this.onDragOver;
        this.div.ondrop = this.onDrop;
    }

    Row.prototype.next = function() {
        return this.index() < this.column.numRows() - 1 && this.column.rows[this.index() + 1] || null;
    };

    Row.prototype.prev = function() {
        return this.index() > 0 && this.column.rows[this.index() - 1] || null;
    };

    Row.prototype.index = function() {
        return this.column.rows.indexOf(this);
    };

    Row.prototype.onMouseOut = function() {
        return this.div.classList.remove('hover');
    };

    Row.prototype.onMouseOver = function() {
        return this.div.classList.add('hover');
    };

    Row.prototype.path = function() {
        var ref1;
        if ((this.item.file != null) && _.isString(this.item.file)) {
            return this.item.file;
        }
        if ((((ref1 = this.item.obj) != null ? ref1.file : void 0) != null) && _.isString(this.item.obj.file)) {
            return this.item.obj.file;
        }
    };

    Row.prototype.setIcon = function() {
        var className, icon, ref1;
        if (this.item.icon) {
            className = this.item.icon;
        } else {
            if (this.item.type === 'dir') {
                className = 'folder-icon';
            } else {
                className = File.iconClassName(this.item.file);
            }
        }
        if (slash.base(this.item.file).startsWith('.')) {
            className += ' dotfile';
        }
        icon = elem('span', {
            "class": className + ' browserFileIcon'
        });
        return (ref1 = this.div.firstChild) != null ? ref1.insertBefore(icon, this.div.firstChild.firstChild) : void 0;
    };

    Row.prototype.activate = function(event) {
        var opt, ref1, ref2, ref3;
        if (this.column.index < 0) {
            this.column.activateRow(this);
            return;
        }
        if ((ref1 = $('.hover')) != null) {
            ref1.classList.remove('hover');
        }
        this.setActive();
        opt = {
            file: this.item.file
        };
        switch (this.item.type) {
            case 'dir':
            case 'file':
                post.emit('filebrowser', 'activateItem', this.item, this.column.index);
                break;
            default:
                if ((this.item.file != null) && _.isString(this.item.file) && this.item.type !== 'obj') {
                    opt.line = this.item.line;
                    opt.col = this.item.column;
                    klog('jumpToFile?', opt);
                } else if ((this.column.parent.obj != null) && this.column.parent.type === 'obj') {
                    if (this.item.type === 'obj') {
                        this.browser.loadObjectItem(this.item, {
                            column: this.column.index + 1
                        });
                        this.browser.previewObjectItem(this.item, {
                            column: this.column.index + 2
                        });
                        if ((((ref2 = this.item.obj) != null ? ref2.file : void 0) != null) && _.isString(this.item.obj.file)) {
                            opt.line = this.item.obj.line;
                            opt.col = this.item.obj.column;
                            klog('jumpToFile?', opt);
                        }
                    }
                } else if ((((ref3 = this.item.obj) != null ? ref3.file : void 0) != null) && _.isString(this.item.obj.file)) {
                    opt = {
                        file: this.item.obj.file,
                        line: this.item.obj.line,
                        col: this.item.obj.column,
                        newTab: opt.newTab
                    };
                    klog('jumpToFile?', opt);
                } else {
                    this.browser.clearColumnsFrom(this.column.index + 1);
                }
        }
        return this;
    };

    Row.prototype.isActive = function() {
        return this.div.classList.contains('active');
    };

    Row.prototype.setActive = function(opt) {
        var ref1;
        if (opt == null) {
            opt = {};
        }
        if ((ref1 = this.column.activeRow()) != null) {
            ref1.clearActive();
        }
        this.div.classList.add('active');
        if ((opt != null ? opt.scroll : void 0) !== false) {
            this.column.scroll.toIndex(this.index());
        }
        return this;
    };

    Row.prototype.clearActive = function() {
        this.div.classList.remove('active');
        return this;
    };

    Row.prototype.isSelected = function() {
        return this.div.classList.contains('selected');
    };

    Row.prototype.setSelected = function() {
        this.div.classList.add('selected');
        return this;
    };

    Row.prototype.clearSelected = function() {
        this.div.classList.remove('selected');
        return this;
    };

    Row.prototype.editName = function() {
        if (this.input != null) {
            return;
        }
        this.input = elem('input', {
            "class": 'rowNameInput'
        });
        this.input.value = slash.file(this.item.file);
        this.div.appendChild(this.input);
        this.input.addEventListener('change', this);
        this.input.addEventListener('keydown', this.onNameKeyDown);
        this.input.addEventListener('focusout', this.onNameFocusOut);
        this.input.focus();
        return this.input.setSelectionRange(0, slash.base(this.item.file).length);
    };

    Row.prototype.onNameKeyDown = function(event) {
        var combo, key, mod, ref1;
        ref1 = keyinfo.forEvent(event), mod = ref1.mod, key = ref1.key, combo = ref1.combo;
        switch (combo) {
            case 'esc':
                if (this.input.value !== slash.file(this.item.file)) {
                    this.input.value = slash.file(this.item.file);
                    event.preventDefault();
                    event.stopImmediatePropagation();
                }
                this.onNameFocusOut();
                break;
            case 'enter':
                if (this.input.value !== slash.file(this.item.file)) {
                    this.onNameChange();
                } else {
                    this.removeInput();
                }
                stopEvent(event);
        }
        return event.stopPropagation();
    };

    Row.prototype.removeInput = function() {
        if (this.input == null) {
            return;
        }
        this.input.removeEventListener('focusout', this.onNameFocusOut);
        this.input.removeEventListener('change', this.onNameChange);
        this.input.removeEventListener('keydown', this.onNameKeyDown);
        this.input.remove();
        delete this.input;
        this.input = null;
        if ((document.activeElement == null) || document.activeElement === document.body) {
            return this.column.focus({
                activate: false
            });
        }
    };

    Row.prototype.onNameFocusOut = function(event) {
        return this.removeInput();
    };

    Row.prototype.onNameChange = function(event) {
        var targetFile;
        targetFile = slash.join(slash.dir(this.item.file), this.input.value.trim());
        this.removeInput();
        return this.rename(targetFile);
    };

    Row.prototype.rename = function(targetFile) {
        if (slash.samePath(this.item.file, targetFile)) {
            return;
        }
        return File.rename(this.item.file, targetFile, (function(_this) {
            return function(newFile) {
                _this.column.removeRow(_this);
                return _this.browser.navigateToFile(newFile);
            };
        })(this));
    };

    Row.prototype.onMouseDown = function(event) {
        klog('onMouseDown', event.shiftKey, event.altKey, event.ctrlKey);
        if (event.shiftKey) {
            return this.browser.select.to(this);
        } else if (event.metaKey || event.altKey || event.ctrlKey) {
            return this.browser.select.toggle(this);
        } else {
            return this.browser.select.row(this, false);
        }
    };

    Row.prototype.onDragStart = function(event) {
        klog('dragStart', event.shiftKey);
        if (empty(this.browser.select.files())) {
            event.preventDefault();
            return;
        }
        if (!this.isSelected()) {
            this.column.onClick(event);
        }
        klog('dragStart', this.isActive(), this.isSelected(), this.browser.select.files());
        event.dataTransfer.setData('text/plain', this.browser.select.files().join('\n'));
        this.column.focus({
            activate: false
        });
        return this.setActive({
            scroll: false
        });
    };

    Row.prototype.onDragOver = function(event) {
        event.dataTransfer.dropEffect = event.getModifierState('Shift') && 'copy' || 'move';
        return event.preventDefault();
    };

    Row.prototype.onDrop = function(event) {
        var action, ref1, ref2, source, target;
        if (this.column.index < 0 && !event.getModifierState('Shift') && !event.getModifierState('Control')) {
            this.column.onDrop(event);
            return;
        }
        action = event.getModifierState('Shift') && 'copy' || 'move';
        target = (ref1 = this.item) != null ? ref1.file : void 0;
        source = event.dataTransfer.getData('text/plain');
        this.browser.dropAction(event, (ref2 = this.item) != null ? ref2.file : void 0);
        return stopEvent(event);
    };

    return Row;

})();

module.exports = Row;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm93LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSx1SEFBQTtJQUFBOztBQVFBLE1BQStGLE9BQUEsQ0FBUSxLQUFSLENBQS9GLEVBQUUsZUFBRixFQUFRLHFCQUFSLEVBQWlCLGVBQWpCLEVBQXVCLGlCQUF2QixFQUE4Qix5QkFBOUIsRUFBeUMsaUJBQXpDLEVBQWdELGlCQUFoRCxFQUF1RCxlQUF2RCxFQUE2RCxpQkFBN0QsRUFBb0UsZUFBcEUsRUFBMEUsbUJBQTFFLEVBQWtGLFdBQWxGLEVBQXNGLFNBQXRGLEVBQXlGOztBQUV6RixRQUFBLEdBQVksT0FBQSxDQUFRLFVBQVI7O0FBQ1osSUFBQSxHQUFZLE9BQUEsQ0FBUSxjQUFSOztBQUVaLEdBQUEsR0FBTSxRQUFRLENBQUMsTUFBTSxDQUFDOztBQUVoQjtJQUVXLGFBQUMsTUFBRCxFQUFVLElBQVY7QUFFVCxZQUFBO1FBRlUsSUFBQyxDQUFBLFNBQUQ7UUFBUyxJQUFDLENBQUEsT0FBRDs7Ozs7Ozs7Ozs7UUFFbkIsSUFBQyxDQUFBLE9BQUQsR0FBVyxJQUFDLENBQUEsTUFBTSxDQUFDO1FBQ25CLElBQUEsNENBQW9CLElBQUMsQ0FBQSxJQUFJLENBQUM7UUFDMUIsSUFBRyxLQUFBLENBQU0sSUFBTixDQUFBLElBQWUsS0FBQSxDQUFNLElBQUksQ0FBQyxJQUFMLENBQUEsQ0FBTixDQUFsQjtZQUNJLElBQUEsR0FBTyxpQkFEWDtTQUFBLE1BQUE7WUFHSSxJQUFBLEdBQU8sSUFBSSxDQUFDLElBQUwsQ0FBVSxJQUFWLEVBSFg7O1FBSUEsSUFBQyxDQUFBLEdBQUQsR0FBTyxJQUFBLENBQUs7WUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFNLFlBQU47WUFBbUIsSUFBQSxFQUFLLElBQXhCO1lBQThCLFNBQUEsRUFBVSxJQUF4QztTQUFMO1FBQ1AsSUFBQyxDQUFBLEdBQUcsQ0FBQyxTQUFTLENBQUMsR0FBZixD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QVMsS0FBSyxDQUFDLFlBQVksQ0FBQyxPQUFuQixDQUEyQixZQUEzQjtRQUNULElBQUMsQ0FBQSxPQUFPLENBQUMsVUFBVCxDQUFvQixLQUFwQixtQ0FBZ0MsQ0FBRSxhQUFsQztlQUNBLFNBQUEsQ0FBVSxLQUFWO0lBVkk7Ozs7OztBQVlaLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwXG4wMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4wMDAgICAwMDAgICAwMDAwMDAwICAgMDAgICAgIDAwXG4jIyNcblxueyBlbGVtLCBrZXlpbmZvLCBkcmFnLCBjbGFtcCwgc3RvcEV2ZW50LCB2YWxpZCwgZW1wdHksIHBvc3QsIHNsYXNoLCBrbG9nLCBrZXJyb3IsIGZzLCAkLCBfIH0gPSByZXF1aXJlICdreGsnIFxuXG5lbGVjdHJvbiAgPSByZXF1aXJlICdlbGVjdHJvbidcbkZpbGUgICAgICA9IHJlcXVpcmUgJy4vdG9vbHMvZmlsZSdcblxuYXBwID0gZWxlY3Ryb24ucmVtb3RlLmFwcFxuXG5jbGFzcyBSb3dcbiAgICBcbiAgICBjb25zdHJ1Y3RvcjogKEBjb2x1bW4sIEBpdGVtKSAtPlxuXG4gICAgICAgIEBicm93c2VyID0gQGNvbHVtbi5icm93c2VyXG4gICAgICAgIHRleHQgPSBAaXRlbS50ZXh0ID8gQGl0ZW0ubmFtZVxuICAgICAgICBpZiBlbXB0eSh0ZXh0KSBvciBlbXB0eSB0ZXh0LnRyaW0oKVxuICAgICAgICAgICAgaHRtbCA9ICc8c3Bhbj4gPC9zcGFuPidcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgaHRtbCA9IEZpbGUuc3BhbiB0ZXh0XG4gICAgICAgIEBkaXYgPSBlbGVtIGNsYXNzOidicm93c2VyUm93JyBodG1sOmh0bWwsIGRyYWdnYWJsZTp0cnVlXG4gICAgICAgIEBkaXYuY2xhc3NMaXN0LmFkZCBAaXRlbS50eXBlXG4gICAgICAgIEBjb2x1bW4udGFibGUuYXBwZW5kQ2hpbGQgQGRpdlxuXG4gICAgICAgIGlmIEBpdGVtLnR5cGUgaW4gWydmaWxlJyAnZGlyJ10gb3IgQGl0ZW0uaWNvblxuICAgICAgICAgICAgQHNldEljb24oKVxuICAgICAgICBcbiAgICAgICAgQGRpdi5vbm1vdXNlZG93biA9IEBvbk1vdXNlRG93blxuICAgICAgICBAZGl2Lm9uZHJhZ3N0YXJ0ID0gQG9uRHJhZ1N0YXJ0XG4gICAgICAgIEBkaXYub25kcmFnb3ZlciAgPSBAb25EcmFnT3ZlclxuICAgICAgICBAZGl2Lm9uZHJvcCAgICAgID0gQG9uRHJvcFxuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICBuZXh0OiAgICAgICAgLT4gQGluZGV4KCkgPCBAY29sdW1uLm51bVJvd3MoKS0xIGFuZCBAY29sdW1uLnJvd3NbQGluZGV4KCkrMV0gb3IgbnVsbFxuICAgIHByZXY6ICAgICAgICAtPiBAaW5kZXgoKSA+IDAgYW5kIEBjb2x1bW4ucm93c1tAaW5kZXgoKS0xXSBvciBudWxsXG4gICAgaW5kZXg6ICAgICAgIC0+IEBjb2x1bW4ucm93cy5pbmRleE9mIEAgICAgXG4gICAgb25Nb3VzZU91dDogIC0+IEBkaXYuY2xhc3NMaXN0LnJlbW92ZSAnaG92ZXInXG4gICAgb25Nb3VzZU92ZXI6IC0+IEBkaXYuY2xhc3NMaXN0LmFkZCAnaG92ZXInXG5cbiAgICBwYXRoOiAtPiBcbiAgICAgICAgaWYgQGl0ZW0uZmlsZT8gYW5kIF8uaXNTdHJpbmcgQGl0ZW0uZmlsZVxuICAgICAgICAgICAgcmV0dXJuIEBpdGVtLmZpbGVcbiAgICAgICAgaWYgQGl0ZW0ub2JqPy5maWxlPyBhbmQgXy5pc1N0cmluZyBAaXRlbS5vYmouZmlsZVxuICAgICAgICAgICAgcmV0dXJuIEBpdGVtLm9iai5maWxlXG5cbiAgICBzZXRJY29uOiAtPlxuXG4gICAgICAgIGlmIEBpdGVtLmljb25cbiAgICAgICAgICAgIGNsYXNzTmFtZSA9IEBpdGVtLmljb25cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgaWYgQGl0ZW0udHlwZSA9PSAnZGlyJ1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdmb2xkZXItaWNvbidcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBGaWxlLmljb25DbGFzc05hbWUgQGl0ZW0uZmlsZVxuICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiBzbGFzaC5iYXNlKEBpdGVtLmZpbGUpLnN0YXJ0c1dpdGgoJy4nKVxuICAgICAgICAgICAgY2xhc3NOYW1lICs9ICcgZG90ZmlsZSdcbiAgICAgICAgICAgIFxuICAgICAgICBpY29uID0gZWxlbSgnc3BhbicgY2xhc3M6Y2xhc3NOYW1lICsgJyBicm93c2VyRmlsZUljb24nKVxuICAgICAgICAgICAgXG4gICAgICAgIEBkaXYuZmlyc3RDaGlsZD8uaW5zZXJ0QmVmb3JlIGljb24sIEBkaXYuZmlyc3RDaGlsZC5maXJzdENoaWxkXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAwMDAgICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgMCAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgYWN0aXZhdGU6IChldmVudCkgPT5cblxuICAgICAgICBpZiBAY29sdW1uLmluZGV4IDwgMCAjIHNoZWxmIGhhbmRsZXMgcm93IGFjdGl2YXRpb25cbiAgICAgICAgICAgIEBjb2x1bW4uYWN0aXZhdGVSb3cgQFxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAkKCcuaG92ZXInKT8uY2xhc3NMaXN0LnJlbW92ZSAnaG92ZXInXG4gICAgICAgIFxuICAgICAgICBAc2V0QWN0aXZlKClcbiAgICAgICAgXG4gICAgICAgIG9wdCA9IGZpbGU6QGl0ZW0uZmlsZVxuXG4gICAgICAgIHN3aXRjaCBAaXRlbS50eXBlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHdoZW4gJ2RpcicgJ2ZpbGUnXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIyBrbG9nICdyb3cuYWN0aXZhdGVJdGVtJyBAaXRlbS5maWxlLCBAY29sdW1uLmluZGV4XG4gICAgICAgICAgICAgICAgcG9zdC5lbWl0ICdmaWxlYnJvd3NlcicgJ2FjdGl2YXRlSXRlbScgQGl0ZW0sIEBjb2x1bW4uaW5kZXhcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGVsc2UgICAgXG4gICAgICAgICAgICAgICAgaWYgQGl0ZW0uZmlsZT8gYW5kIF8uaXNTdHJpbmcoQGl0ZW0uZmlsZSkgYW5kIEBpdGVtLnR5cGUgIT0gJ29iaidcbiAgICAgICAgICAgICAgICAgICAgb3B0LmxpbmUgPSBAaXRlbS5saW5lXG4gICAgICAgICAgICAgICAgICAgIG9wdC5jb2wgID0gQGl0ZW0uY29sdW1uXG4gICAgICAgICAgICAgICAgICAgIGtsb2cgJ2p1bXBUb0ZpbGU/JyBvcHRcbiAgICAgICAgICAgICAgICBlbHNlIGlmIEBjb2x1bW4ucGFyZW50Lm9iaj8gYW5kIEBjb2x1bW4ucGFyZW50LnR5cGUgPT0gJ29iaidcbiAgICAgICAgICAgICAgICAgICAgaWYgQGl0ZW0udHlwZSA9PSAnb2JqJ1xuICAgICAgICAgICAgICAgICAgICAgICAgQGJyb3dzZXIubG9hZE9iamVjdEl0ZW0gQGl0ZW0sIGNvbHVtbjpAY29sdW1uLmluZGV4KzFcbiAgICAgICAgICAgICAgICAgICAgICAgIEBicm93c2VyLnByZXZpZXdPYmplY3RJdGVtICBAaXRlbSwgY29sdW1uOkBjb2x1bW4uaW5kZXgrMlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgQGl0ZW0ub2JqPy5maWxlPyBhbmQgXy5pc1N0cmluZyBAaXRlbS5vYmouZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdC5saW5lID0gQGl0ZW0ub2JqLmxpbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHQuY29sICA9IEBpdGVtLm9iai5jb2x1bW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbG9nICdqdW1wVG9GaWxlPycgb3B0XG4gICAgICAgICAgICAgICAgZWxzZSBpZiBAaXRlbS5vYmo/LmZpbGU/IGFuZCBfLmlzU3RyaW5nIEBpdGVtLm9iai5maWxlXG4gICAgICAgICAgICAgICAgICAgIG9wdCA9IGZpbGU6QGl0ZW0ub2JqLmZpbGUsIGxpbmU6QGl0ZW0ub2JqLmxpbmUsIGNvbDpAaXRlbS5vYmouY29sdW1uLCBuZXdUYWI6b3B0Lm5ld1RhYlxuICAgICAgICAgICAgICAgICAgICBrbG9nICdqdW1wVG9GaWxlPycgb3B0XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBAYnJvd3Nlci5jbGVhckNvbHVtbnNGcm9tIEBjb2x1bW4uaW5kZXgrMVxuICAgICAgICBAXG4gICAgXG4gICAgaXNBY3RpdmU6IC0+IEBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zICdhY3RpdmUnXG4gICAgXG4gICAgc2V0QWN0aXZlOiAob3B0PXt9KSAtPlxuICAgICAgICBcbiAgICAgICAgQGNvbHVtbi5hY3RpdmVSb3coKT8uY2xlYXJBY3RpdmUoKVxuICAgICAgICBAZGl2LmNsYXNzTGlzdC5hZGQgJ2FjdGl2ZSdcbiAgICAgICAgXG4gICAgICAgIGlmIG9wdD8uc2Nyb2xsICE9IGZhbHNlXG4gICAgICAgICAgICBAY29sdW1uLnNjcm9sbC50b0luZGV4IEBpbmRleCgpICAgICAgICAgICAgXG4gICAgICAgIEBcbiAgICAgICAgICAgICAgICAgXG4gICAgY2xlYXJBY3RpdmU6IC0+XG4gICAgICAgIEBkaXYuY2xhc3NMaXN0LnJlbW92ZSAnYWN0aXZlJ1xuICAgICAgICBAXG4gICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAgICAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuICAgICMgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgMDAwMDAwMCAgICBcbiAgICBcbiAgICBpc1NlbGVjdGVkOiAtPiBAZGl2LmNsYXNzTGlzdC5jb250YWlucyAnc2VsZWN0ZWQnXG4gICAgXG4gICAgc2V0U2VsZWN0ZWQ6IC0+XG4gICAgICAgIEBkaXYuY2xhc3NMaXN0LmFkZCAnc2VsZWN0ZWQnXG4gICAgICAgIEBcbiAgICAgICAgXG4gICAgY2xlYXJTZWxlY3RlZDogLT5cbiAgICAgICAgQGRpdi5jbGFzc0xpc3QucmVtb3ZlICdzZWxlY3RlZCdcbiAgICAgICAgQFxuXG4gICAgIyAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAgICAgIDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwICAgXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG4gICAgICAgICAgICBcbiAgICBlZGl0TmFtZTogPT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBAaW5wdXQ/IFxuICAgICAgICBAaW5wdXQgPSBlbGVtICdpbnB1dCcgY2xhc3M6J3Jvd05hbWVJbnB1dCdcbiAgICAgICAgQGlucHV0LnZhbHVlID0gc2xhc2guZmlsZSBAaXRlbS5maWxlXG4gICAgICAgIFxuICAgICAgICBAZGl2LmFwcGVuZENoaWxkIEBpbnB1dFxuICAgICAgICBAaW5wdXQuYWRkRXZlbnRMaXN0ZW5lciAnY2hhbmdlJyAgIEBcbiAgICAgICAgXG4gICAgICAgIEBpbnB1dC5hZGRFdmVudExpc3RlbmVyICdrZXlkb3duJyAgQG9uTmFtZUtleURvd25cbiAgICAgICAgQGlucHV0LmFkZEV2ZW50TGlzdGVuZXIgJ2ZvY3Vzb3V0JyBAb25OYW1lRm9jdXNPdXRcbiAgICAgICAgQGlucHV0LmZvY3VzKClcbiAgICAgICAgXG4gICAgICAgIEBpbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSAwLCBzbGFzaC5iYXNlKEBpdGVtLmZpbGUpLmxlbmd0aFxuXG4gICAgb25OYW1lS2V5RG93bjogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAge21vZCwga2V5LCBjb21ib30gPSBrZXlpbmZvLmZvckV2ZW50IGV2ZW50XG5cbiAgICAgICAgc3dpdGNoIGNvbWJvXG4gICAgICAgICAgICB3aGVuICdlc2MnXG4gICAgICAgICAgICAgICAgaWYgQGlucHV0LnZhbHVlICE9IHNsYXNoLmZpbGUgQGl0ZW0uZmlsZVxuICAgICAgICAgICAgICAgICAgICBAaW5wdXQudmFsdWUgPSBzbGFzaC5maWxlIEBpdGVtLmZpbGVcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKVxuICAgICAgICAgICAgICAgIEBvbk5hbWVGb2N1c091dCgpXG4gICAgICAgICAgICB3aGVuICdlbnRlcidcbiAgICAgICAgICAgICAgICBpZiBAaW5wdXQudmFsdWUgIT0gc2xhc2guZmlsZSBAaXRlbS5maWxlXG4gICAgICAgICAgICAgICAgICAgIEBvbk5hbWVDaGFuZ2UoKVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgQHJlbW92ZUlucHV0KClcbiAgICAgICAgICAgICAgICBzdG9wRXZlbnQgZXZlbnRcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgXG4gICAgcmVtb3ZlSW5wdXQ6IC0+XG5cbiAgICAgICAgcmV0dXJuIGlmIG5vdCBAaW5wdXQ/XG4gICAgICAgIEBpbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyICdmb2N1c291dCcgQG9uTmFtZUZvY3VzT3V0XG4gICAgICAgIEBpbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyICdjaGFuZ2UnICAgQG9uTmFtZUNoYW5nZVxuICAgICAgICBAaW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lciAna2V5ZG93bicgIEBvbk5hbWVLZXlEb3duXG4gICAgICAgIEBpbnB1dC5yZW1vdmUoKVxuICAgICAgICBkZWxldGUgQGlucHV0XG4gICAgICAgIEBpbnB1dCA9IG51bGxcbiAgICAgICAgaWYgbm90IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ/IG9yIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT0gZG9jdW1lbnQuYm9keVxuICAgICAgICAgICAgQGNvbHVtbi5mb2N1cyBhY3RpdmF0ZTpmYWxzZVxuICAgIFxuICAgIG9uTmFtZUZvY3VzT3V0OiAoZXZlbnQpID0+IEByZW1vdmVJbnB1dCgpXG4gICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgb25OYW1lQ2hhbmdlOiAoZXZlbnQpID0+XG4gICAgICAgIFxuICAgICAgICB0YXJnZXRGaWxlID0gc2xhc2guam9pbiBzbGFzaC5kaXIoQGl0ZW0uZmlsZSksIEBpbnB1dC52YWx1ZS50cmltKClcbiAgICAgICAgXG4gICAgICAgIEByZW1vdmVJbnB1dCgpXG4gICAgICAgIFxuICAgICAgICBAcmVuYW1lIHRhcmdldEZpbGVcbiAgICAgICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAgICAgIDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgMCAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG4gICAgXG4gICAgcmVuYW1lOiAodGFyZ2V0RmlsZSkgPT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBzbGFzaC5zYW1lUGF0aCBAaXRlbS5maWxlLCB0YXJnZXRGaWxlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgIEZpbGUucmVuYW1lIEBpdGVtLmZpbGUsIHRhcmdldEZpbGUsIChuZXdGaWxlKSA9PlxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAY29sdW1uLnJlbW92ZVJvdyBAXG4gICAgICAgICAgICBAYnJvd3Nlci5uYXZpZ2F0ZVRvRmlsZSBuZXdGaWxlXG4gICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICBcbiAgICBcbiAgICBvbk1vdXNlRG93bjogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAga2xvZyAnb25Nb3VzZURvd24nIGV2ZW50LnNoaWZ0S2V5LCBldmVudC5hbHRLZXksIGV2ZW50LmN0cmxLZXlcbiAgICAgICAgXG4gICAgICAgIGlmIGV2ZW50LnNoaWZ0S2V5XG4gICAgICAgICAgICBAYnJvd3Nlci5zZWxlY3QudG8gQFxuICAgICAgICBlbHNlIGlmIGV2ZW50Lm1ldGFLZXkgb3IgZXZlbnQuYWx0S2V5IG9yIGV2ZW50LmN0cmxLZXlcbiAgICAgICAgICAgIEBicm93c2VyLnNlbGVjdC50b2dnbGUgQFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAYnJvd3Nlci5zZWxlY3Qucm93IEAsIGZhbHNlXG4gICAgXG4gICAgb25EcmFnU3RhcnQ6IChldmVudCkgPT5cbiAgICAgICAgXG4gICAgICAgIGtsb2cgJ2RyYWdTdGFydCcgZXZlbnQuc2hpZnRLZXlcbiAgICAgICAgXG4gICAgICAgIGlmIGVtcHR5IEBicm93c2VyLnNlbGVjdC5maWxlcygpXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICByZXR1cm4gXG4gICAgICAgIFxuICAgICAgICBpZiBub3QgQGlzU2VsZWN0ZWQoKVxuICAgICAgICAgICAgQGNvbHVtbi5vbkNsaWNrIGV2ZW50XG4gICAgICAgIGtsb2cgJ2RyYWdTdGFydCcgQGlzQWN0aXZlKCksIEBpc1NlbGVjdGVkKCksIEBicm93c2VyLnNlbGVjdC5maWxlcygpXG4gICAgICAgIFxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSAndGV4dC9wbGFpbicgQGJyb3dzZXIuc2VsZWN0LmZpbGVzKCkuam9pbiAnXFxuJ1xuXG4gICAgICAgIEBjb2x1bW4uZm9jdXMgYWN0aXZhdGU6ZmFsc2VcbiAgICAgICAgQHNldEFjdGl2ZSBzY3JvbGw6ZmFsc2VcbiAgICAgICAgXG4gICAgb25EcmFnT3ZlcjogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSBldmVudC5nZXRNb2RpZmllclN0YXRlKCdTaGlmdCcpIGFuZCAnY29weScgb3IgJ21vdmUnXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgXG4gICAgb25Ecm9wOiAoZXZlbnQpID0+IFxuICAgIFxuICAgICAgICBpZiBAY29sdW1uLmluZGV4IDwgMCBhbmQgbm90IGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoJ1NoaWZ0JykgYW5kIG5vdCBldmVudC5nZXRNb2RpZmllclN0YXRlKCdDb250cm9sJylcbiAgICAgICAgICAgIEBjb2x1bW4ub25Ecm9wIGV2ZW50XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIFxuICAgICAgICBhY3Rpb24gPSBldmVudC5nZXRNb2RpZmllclN0YXRlKCdTaGlmdCcpIGFuZCAnY29weScgb3IgJ21vdmUnXG4gICAgICAgIHRhcmdldCA9IEBpdGVtPy5maWxlXG4gICAgICAgIHNvdXJjZSA9IGV2ZW50LmRhdGFUcmFuc2Zlci5nZXREYXRhICd0ZXh0L3BsYWluJ1xuICAgICAgICBAYnJvd3Nlci5kcm9wQWN0aW9uIGV2ZW50LCBAaXRlbT8uZmlsZVxuICAgICAgICBzdG9wRXZlbnQgZXZlbnRcblxubW9kdWxlLmV4cG9ydHMgPSBSb3dcbiJdfQ==
//# sourceURL=../coffee/row.coffee