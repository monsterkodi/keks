// koffee 1.4.0

/*
00000000    0000000   000   000
000   000  000   000  000 0 000
0000000    000   000  000000000
000   000  000   000  000   000
000   000   0000000   00     00
 */
var $, File, Row, _, app, clamp, electron, elem, empty, fs, kerror, keyinfo, klog, post, ref, slash, stopEvent, valid,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), elem = ref.elem, keyinfo = ref.keyinfo, clamp = ref.clamp, stopEvent = ref.stopEvent, valid = ref.valid, empty = ref.empty, post = ref.post, slash = ref.slash, klog = ref.klog, kerror = ref.kerror, fs = ref.fs, $ = ref.$, _ = ref._;

electron = require('electron');

File = require('./tools/file');

app = electron.remote.app;

Row = (function() {
    function Row(column, item) {
        var html, ref1, ref2, text;
        this.column = column;
        this.item = item;
        this.rename = bind(this.rename, this);
        this.onNameChange = bind(this.onNameChange, this);
        this.onNameFocusOut = bind(this.onNameFocusOut, this);
        this.onNameKeyDown = bind(this.onNameKeyDown, this);
        this.editName = bind(this.editName, this);
        this.activate = bind(this.activate, this);
        this.browser = this.column.browser;
        text = (ref1 = this.item.text) != null ? ref1 : this.item.name;
        if (empty(text) || empty(text.trim())) {
            html = '<span> </span>';
        } else {
            html = File.span(text);
        }
        this.div = elem({
            "class": 'browserRow',
            html: html
        });
        this.div.classList.add(this.item.type);
        this.column.table.appendChild(this.div);
        if (((ref2 = this.item.type) === 'file' || ref2 === 'dir') || this.item.icon) {
            this.setIcon();
        }
    }

    Row.prototype.next = function() {
        return this.index() < this.column.numRows() - 1 && this.column.rows[this.index() + 1] || null;
    };

    Row.prototype.prev = function() {
        return this.index() > 0 && this.column.rows[this.index() - 1] || null;
    };

    Row.prototype.index = function() {
        return this.column.rows.indexOf(this);
    };

    Row.prototype.onMouseOut = function() {
        return this.div.classList.remove('hover');
    };

    Row.prototype.onMouseOver = function() {
        return this.div.classList.add('hover');
    };

    Row.prototype.path = function() {
        var ref1;
        if ((this.item.file != null) && _.isString(this.item.file)) {
            return this.item.file;
        }
        if ((((ref1 = this.item.obj) != null ? ref1.file : void 0) != null) && _.isString(this.item.obj.file)) {
            return this.item.obj.file;
        }
    };

    Row.prototype.setIcon = function() {
        var className, icon, ref1;
        if (this.item.icon) {
            className = this.item.icon;
        } else {
            if (this.item.type === 'dir') {
                className = 'folder-icon';
            } else {
                className = File.iconClassName(this.item.file);
            }
        }
        if (slash.base(this.item.file).startsWith('.')) {
            className += ' dotfile';
        }
        icon = elem('span', {
            "class": className + ' browserFileIcon'
        });
        return (ref1 = this.div.firstChild) != null ? ref1.insertBefore(icon, this.div.firstChild.firstChild) : void 0;
    };

    Row.prototype.activate = function(event) {
        var col, opt, ref1, ref2, ref3;
        if (this.column.index < 0) {
            this.column.activateRow(this);
            return;
        }
        if ((ref1 = $('.hover')) != null) {
            ref1.classList.remove('hover');
        }
        this.setActive();
        opt = {
            file: this.item.file
        };
        switch (this.item.type) {
            case 'dir':
            case 'file':
                col = this.column.index;
                this.browser.clearColumnsFrom(col + 1, {
                    pop: true,
                    clear: col + 1
                });
                switch (this.item.type) {
                    case 'dir':
                        this.browser.loadDirItem(this.item, col + 1, {
                            focus: false
                        });
                        break;
                    case 'file':
                        this.browser.loadFileItem(this.item, col + 1);
                }
                this.browser.select.row(this, false);
                break;
            default:
                if ((this.item.file != null) && _.isString(this.item.file) && this.item.type !== 'obj') {
                    opt.line = this.item.line;
                    opt.col = this.item.column;
                    klog('jumpToFile?', opt);
                } else if ((this.column.parent.obj != null) && this.column.parent.type === 'obj') {
                    if (this.item.type === 'obj') {
                        this.browser.loadObjectItem(this.item, {
                            column: this.column.index + 1
                        });
                        this.browser.previewObjectItem(this.item, {
                            column: this.column.index + 2
                        });
                        if ((((ref2 = this.item.obj) != null ? ref2.file : void 0) != null) && _.isString(this.item.obj.file)) {
                            opt.line = this.item.obj.line;
                            opt.col = this.item.obj.column;
                            klog('jumpToFile?', opt);
                        }
                    }
                } else if ((((ref3 = this.item.obj) != null ? ref3.file : void 0) != null) && _.isString(this.item.obj.file)) {
                    opt = {
                        file: this.item.obj.file,
                        line: this.item.obj.line,
                        col: this.item.obj.column,
                        newTab: opt.newTab
                    };
                    klog('jumpToFile?', opt);
                } else {
                    this.browser.clearColumnsFrom(this.column.index + 1);
                }
        }
        return this;
    };

    Row.prototype.isActive = function() {
        return this.div.classList.contains('active');
    };

    Row.prototype.setActive = function(opt) {
        var ref1;
        if (opt == null) {
            opt = {};
        }
        if (this.column.activeRow() !== this) {
            if ((ref1 = this.column.activeRow()) != null) {
                ref1.clearActive();
            }
        }
        this.div.classList.add('active');
        if ((opt != null ? opt.scroll : void 0) !== false) {
            this.column.scroll.toIndex(this.index());
        }
        return this;
    };

    Row.prototype.clearActive = function() {
        this.div.classList.remove('active');
        return this;
    };

    Row.prototype.isSelected = function() {
        return this.div.classList.contains('selected');
    };

    Row.prototype.setSelected = function() {
        this.div.classList.add('selected');
        return this;
    };

    Row.prototype.clearSelected = function() {
        this.div.classList.remove('selected');
        return this;
    };

    Row.prototype.editName = function() {
        if (this.input != null) {
            return;
        }
        this.input = elem('input', {
            "class": 'rowNameInput'
        });
        this.input.value = slash.file(this.item.file);
        this.div.appendChild(this.input);
        this.input.addEventListener('change', this);
        this.input.addEventListener('keydown', this.onNameKeyDown);
        this.input.addEventListener('focusout', this.onNameFocusOut);
        this.input.focus();
        return this.input.setSelectionRange(0, slash.base(this.item.file).length);
    };

    Row.prototype.onNameKeyDown = function(event) {
        var combo, key, mod, ref1;
        ref1 = keyinfo.forEvent(event), mod = ref1.mod, key = ref1.key, combo = ref1.combo;
        switch (combo) {
            case 'esc':
                if (this.input.value !== slash.file(this.item.file)) {
                    this.input.value = slash.file(this.item.file);
                    event.preventDefault();
                    event.stopImmediatePropagation();
                }
                this.onNameFocusOut();
                break;
            case 'enter':
                if (this.input.value !== slash.file(this.item.file)) {
                    this.onNameChange();
                } else {
                    this.removeInput();
                }
                stopEvent(event);
        }
        return event.stopPropagation();
    };

    Row.prototype.removeInput = function() {
        if (this.input == null) {
            return;
        }
        this.input.removeEventListener('focusout', this.onNameFocusOut);
        this.input.removeEventListener('change', this.onNameChange);
        this.input.removeEventListener('keydown', this.onNameKeyDown);
        this.input.remove();
        delete this.input;
        this.input = null;
        if ((document.activeElement == null) || document.activeElement === document.body) {
            return this.column.focus({
                activate: false
            });
        }
    };

    Row.prototype.onNameFocusOut = function(event) {
        return this.removeInput();
    };

    Row.prototype.onNameChange = function(event) {
        var targetFile;
        targetFile = slash.join(slash.dir(this.item.file), this.input.value.trim());
        this.removeInput();
        return this.rename(targetFile);
    };

    Row.prototype.rename = function(targetFile) {
        if (slash.samePath(this.item.file, targetFile)) {
            return;
        }
        return File.rename(this.item.file, targetFile, (function(_this) {
            return function(source, target) {
                _this.column.removeRow(_this);
                return _this.browser.navigateToFile(target);
            };
        })(this));
    };

    return Row;

})();

module.exports = Row;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm93LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxpSEFBQTtJQUFBOztBQVFBLE1BQXlGLE9BQUEsQ0FBUSxLQUFSLENBQXpGLEVBQUUsZUFBRixFQUFRLHFCQUFSLEVBQWlCLGlCQUFqQixFQUF3Qix5QkFBeEIsRUFBbUMsaUJBQW5DLEVBQTBDLGlCQUExQyxFQUFpRCxlQUFqRCxFQUF1RCxpQkFBdkQsRUFBOEQsZUFBOUQsRUFBb0UsbUJBQXBFLEVBQTRFLFdBQTVFLEVBQWdGLFNBQWhGLEVBQW1GOztBQUVuRixRQUFBLEdBQVksT0FBQSxDQUFRLFVBQVI7O0FBQ1osSUFBQSxHQUFZLE9BQUEsQ0FBUSxjQUFSOztBQUVaLEdBQUEsR0FBTSxRQUFRLENBQUMsTUFBTSxDQUFDOztBQUVoQjtJQUVDLGFBQUMsTUFBRCxFQUFVLElBQVY7QUFFQyxZQUFBO1FBRkEsSUFBQyxDQUFBLFNBQUQ7UUFBUyxJQUFDLENBQUEsT0FBRDs7Ozs7OztRQUVULElBQUMsQ0FBQSxPQUFELEdBQVcsSUFBQyxDQUFBLE1BQU0sQ0FBQztRQUNuQixJQUFBLDRDQUFvQixJQUFDLENBQUEsSUFBSSxDQUFDO1FBQzFCLElBQUcsS0FBQSxDQUFNLElBQU4sQ0FBQSxJQUFlLEtBQUEsQ0FBTSxJQUFJLENBQUMsSUFBTCxDQUFBLENBQU4sQ0FBbEI7WUFDSSxJQUFBLEdBQU8saUJBRFg7U0FBQSxNQUFBO1lBR0ksSUFBQSxHQUFPLElBQUksQ0FBQyxJQUFMLENBQVUsSUFBVixFQUhYOztRQUlBLElBQUMsQ0FBQSxHQUFELEdBQU8sSUFBQSxDQUFLO1lBQUEsQ0FBQSxLQUFBLENBQUEsRUFBTSxZQUFOO1lBQW1CLElBQUEsRUFBSyxJQUF4QjtTQUFMO1FBQ1AsSUFBQyxDQUFBLEdBQUcsQ0FBQyxTQUFTLENBQUMsR0FBZixDQUFtQixJQUFDLENBQUEsSUFBSSxDQUFDLElBQXpCO1FBQ0EsSUFB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QUFOLENBQVUsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFoQixDQUFYLEVBQWtDLElBQUMsQ0FBQSxLQUFLLENBQUMsS0FBSyxDQUFDLElBQWIsQ0FBQSxDQUFsQztRQUViLElBQUMsQ0FBQSxXQUFELENBQUE7ZUFFQSxJQUFDLENBQUEsTUFBRCxDQUFRLFVBQVI7SUFOVTs7a0JBY2QsTUFBQSxHQUFRLFNBQUMsVUFBRDtRQUVKLElBQVUsS0FBSyxDQUFDLFFBQU4sQ0FBZSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQXJCLEVBQTJCLFVBQTNCLENBQVY7QUFBQSxtQkFBQTs7ZUFFQSxJQUFJLENBQUMsTUFBTCxDQUFZLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBbEIsRUFBd0IsVUFBeEIsRUFBb0MsQ0FBQSxTQUFBLEtBQUE7bUJBQUEsU0FBQyxNQUFELEVBQVMsTUFBVDtnQkFFaEMsS0FBQyxDQUFBLE1BQU0sQ0FBQyxTQUFSLENBQWtCLEtBQWxCO3VCQUNBLEtBQUMsQ0FBQSxPQUFPLENBQUMsY0FBVCxDQUF3QixNQUF4QjtZQUhnQztRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBcEM7SUFKSTs7Ozs7O0FBNERaLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwXG4wMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4wMDAgICAwMDAgICAwMDAwMDAwICAgMDAgICAgIDAwXG4jIyNcblxueyBlbGVtLCBrZXlpbmZvLCBjbGFtcCwgc3RvcEV2ZW50LCB2YWxpZCwgZW1wdHksIHBvc3QsIHNsYXNoLCBrbG9nLCBrZXJyb3IsIGZzLCAkLCBfIH0gPSByZXF1aXJlICdreGsnIFxuXG5lbGVjdHJvbiAgPSByZXF1aXJlICdlbGVjdHJvbidcbkZpbGUgICAgICA9IHJlcXVpcmUgJy4vdG9vbHMvZmlsZSdcblxuYXBwID0gZWxlY3Ryb24ucmVtb3RlLmFwcFxuXG5jbGFzcyBSb3dcbiAgICBcbiAgICBAOiAoQGNvbHVtbiwgQGl0ZW0pIC0+XG5cbiAgICAgICAgQGJyb3dzZXIgPSBAY29sdW1uLmJyb3dzZXJcbiAgICAgICAgdGV4dCA9IEBpdGVtLnRleHQgPyBAaXRlbS5uYW1lXG4gICAgICAgIGlmIGVtcHR5KHRleHQpIG9yIGVtcHR5IHRleHQudHJpbSgpXG4gICAgICAgICAgICBodG1sID0gJzxzcGFuPiA8L3NwYW4+J1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBodG1sID0gRmlsZS5zcGFuIHRleHRcbiAgICAgICAgQGRpdiA9IGVsZW0gY2xhc3M6J2Jyb3dzZXJSb3cnIGh0bWw6aHRtbCAjLCBkcmFnZ2FibGU6dHJ1ZVxuICAgICAgICBAZGl2LmNsYXNzTGlzdC5hZGQgQGl0ZW0udHlwZVxuICAgICAgICBAY29sdW1uLnRhYmxlLmFwcGVuZENoaWxkIEBkaXZcblxuICAgICAgICBpZiBAaXRlbS50eXBlIGluIFsnZmlsZScgJ2RpciddIG9yIEBpdGVtLmljb25cbiAgICAgICAgICAgIEBzZXRJY29uKClcbiAgICAgICAgXG4gICAgICAgICMgQGRpdi5vbm1vdXNlZG93biA9IEBvbk1vdXNlRG93blxuICAgICAgICAjIEBkaXYub25kcmFnc3RhcnQgPSBAb25EcmFnU3RhcnRcbiAgICAgICAgIyBAZGl2Lm9uZHJhZ292ZXIgID0gQG9uRHJhZ092ZXJcbiAgICAgICAgIyBAZGl2Lm9uZHJvcCAgICAgID0gQG9uRHJvcFxuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICBuZXh0OiAgICAgICAgLT4gQGluZGV4KCkgPCBAY29sdW1uLm51bVJvd3MoKS0xIGFuZCBAY29sdW1uLnJvd3NbQGluZGV4KCkrMV0gb3IgbnVsbFxuICAgIHByZXY6ICAgICAgICAtPiBAaW5kZXgoKSA+IDAgYW5kIEBjb2x1bW4ucm93c1tAaW5kZXgoKS0xXSBvciBudWxsXG4gICAgaW5kZXg6ICAgICAgIC0+IEBjb2x1bW4ucm93cy5pbmRleE9mIEAgICAgXG4gICAgb25Nb3VzZU91dDogIC0+IEBkaXYuY2xhc3NMaXN0LnJlbW92ZSAnaG92ZXInXG4gICAgb25Nb3VzZU92ZXI6IC0+IEBkaXYuY2xhc3NMaXN0LmFkZCAnaG92ZXInXG5cbiAgICBwYXRoOiAtPiBcbiAgICAgICAgaWYgQGl0ZW0uZmlsZT8gYW5kIF8uaXNTdHJpbmcgQGl0ZW0uZmlsZVxuICAgICAgICAgICAgcmV0dXJuIEBpdGVtLmZpbGVcbiAgICAgICAgaWYgQGl0ZW0ub2JqPy5maWxlPyBhbmQgXy5pc1N0cmluZyBAaXRlbS5vYmouZmlsZVxuICAgICAgICAgICAgcmV0dXJuIEBpdGVtLm9iai5maWxlXG5cbiAgICBzZXRJY29uOiAtPlxuXG4gICAgICAgIGlmIEBpdGVtLmljb25cbiAgICAgICAgICAgIGNsYXNzTmFtZSA9IEBpdGVtLmljb25cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgaWYgQGl0ZW0udHlwZSA9PSAnZGlyJ1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdmb2xkZXItaWNvbidcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBGaWxlLmljb25DbGFzc05hbWUgQGl0ZW0uZmlsZVxuICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiBzbGFzaC5iYXNlKEBpdGVtLmZpbGUpLnN0YXJ0c1dpdGgoJy4nKVxuICAgICAgICAgICAgY2xhc3NOYW1lICs9ICcgZG90ZmlsZSdcbiAgICAgICAgICAgIFxuICAgICAgICBpY29uID0gZWxlbSgnc3BhbicgY2xhc3M6Y2xhc3NOYW1lICsgJyBicm93c2VyRmlsZUljb24nKVxuICAgICAgICAgICAgXG4gICAgICAgIEBkaXYuZmlyc3RDaGlsZD8uaW5zZXJ0QmVmb3JlIGljb24sIEBkaXYuZmlyc3RDaGlsZC5maXJzdENoaWxkXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAwMDAgICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgMCAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgYWN0aXZhdGU6IChldmVudCkgPT5cblxuICAgICAgICBpZiBAY29sdW1uLmluZGV4IDwgMCAjIHNoZWxmIGhhbmRsZXMgcm93IGFjdGl2YXRpb25cbiAgICAgICAgICAgIEBjb2x1bW4uYWN0aXZhdGVSb3cgQFxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAkKCcuaG92ZXInKT8uY2xhc3NMaXN0LnJlbW92ZSAnaG92ZXInXG4gICAgICAgIFxuICAgICAgICBAc2V0QWN0aXZlKClcbiAgICAgICAgXG4gICAgICAgIG9wdCA9IGZpbGU6QGl0ZW0uZmlsZVxuXG4gICAgICAgIHN3aXRjaCBAaXRlbS50eXBlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHdoZW4gJ2RpcicgJ2ZpbGUnXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29sID0gQGNvbHVtbi5pbmRleFxuICAgICAgICAgICAgICAgICMga2xvZyAncm93LmFjdGl2YXRlSXRlbScgY29sLCBAaXRlbS5maWxlXG4gICAgICAgICAgICAgICAgQGJyb3dzZXIuY2xlYXJDb2x1bW5zRnJvbSBjb2wrMSwgcG9wOnRydWUsIGNsZWFyOmNvbCsxXG4gICAgICAgIFxuICAgICAgICAgICAgICAgIHN3aXRjaCBAaXRlbS50eXBlXG4gICAgICAgICAgICAgICAgICAgIHdoZW4gJ2RpcicgIHRoZW4gQGJyb3dzZXIubG9hZERpckl0ZW0gIEBpdGVtLCBjb2wrMSwgZm9jdXM6ZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgd2hlbiAnZmlsZScgdGhlbiBAYnJvd3Nlci5sb2FkRmlsZUl0ZW0gQGl0ZW0sIGNvbCsxXG5cbiAgICAgICAgICAgICAgICBAYnJvd3Nlci5zZWxlY3Qucm93IEAsIGZhbHNlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBlbHNlICAgIFxuICAgICAgICAgICAgICAgIGlmIEBpdGVtLmZpbGU/IGFuZCBfLmlzU3RyaW5nKEBpdGVtLmZpbGUpIGFuZCBAaXRlbS50eXBlICE9ICdvYmonXG4gICAgICAgICAgICAgICAgICAgIG9wdC5saW5lID0gQGl0ZW0ubGluZVxuICAgICAgICAgICAgICAgICAgICBvcHQuY29sICA9IEBpdGVtLmNvbHVtblxuICAgICAgICAgICAgICAgICAgICBrbG9nICdqdW1wVG9GaWxlPycgb3B0XG4gICAgICAgICAgICAgICAgZWxzZSBpZiBAY29sdW1uLnBhcmVudC5vYmo/IGFuZCBAY29sdW1uLnBhcmVudC50eXBlID09ICdvYmonXG4gICAgICAgICAgICAgICAgICAgIGlmIEBpdGVtLnR5cGUgPT0gJ29iaidcbiAgICAgICAgICAgICAgICAgICAgICAgIEBicm93c2VyLmxvYWRPYmplY3RJdGVtIEBpdGVtLCBjb2x1bW46QGNvbHVtbi5pbmRleCsxXG4gICAgICAgICAgICAgICAgICAgICAgICBAYnJvd3Nlci5wcmV2aWV3T2JqZWN0SXRlbSAgQGl0ZW0sIGNvbHVtbjpAY29sdW1uLmluZGV4KzJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBpdGVtLm9iaj8uZmlsZT8gYW5kIF8uaXNTdHJpbmcgQGl0ZW0ub2JqLmZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHQubGluZSA9IEBpdGVtLm9iai5saW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0LmNvbCAgPSBAaXRlbS5vYmouY29sdW1uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2xvZyAnanVtcFRvRmlsZT8nIG9wdFxuICAgICAgICAgICAgICAgIGVsc2UgaWYgQGl0ZW0ub2JqPy5maWxlPyBhbmQgXy5pc1N0cmluZyBAaXRlbS5vYmouZmlsZVxuICAgICAgICAgICAgICAgICAgICBvcHQgPSBmaWxlOkBpdGVtLm9iai5maWxlLCBsaW5lOkBpdGVtLm9iai5saW5lLCBjb2w6QGl0ZW0ub2JqLmNvbHVtbiwgbmV3VGFiOm9wdC5uZXdUYWJcbiAgICAgICAgICAgICAgICAgICAga2xvZyAnanVtcFRvRmlsZT8nIG9wdFxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgQGJyb3dzZXIuY2xlYXJDb2x1bW5zRnJvbSBAY29sdW1uLmluZGV4KzFcbiAgICAgICAgQFxuICAgIFxuICAgIGlzQWN0aXZlOiAtPiBAZGl2LmNsYXNzTGlzdC5jb250YWlucyAnYWN0aXZlJ1xuICAgIFxuICAgIHNldEFjdGl2ZTogKG9wdD17fSkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBjb2x1bW4uYWN0aXZlUm93KCkgIT0gQFxuICAgICAgICAgICAgQGNvbHVtbi5hY3RpdmVSb3coKT8uY2xlYXJBY3RpdmUoKVxuICAgICAgICAgICAgXG4gICAgICAgIEBkaXYuY2xhc3NMaXN0LmFkZCAnYWN0aXZlJ1xuICAgICAgICBcbiAgICAgICAgaWYgb3B0Py5zY3JvbGwgIT0gZmFsc2VcbiAgICAgICAgICAgIEBjb2x1bW4uc2Nyb2xsLnRvSW5kZXggQGluZGV4KCkgICAgICAgICAgICBcbiAgICAgICAgQFxuICAgICAgICAgICAgICAgICBcbiAgICBjbGVhckFjdGl2ZTogLT5cbiAgICAgICAgQGRpdi5jbGFzc0xpc3QucmVtb3ZlICdhY3RpdmUnXG4gICAgICAgIEBcbiAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICAwMDAwMDAwICAgIFxuICAgIFxuICAgIGlzU2VsZWN0ZWQ6IC0+IEBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zICdzZWxlY3RlZCdcbiAgICBcbiAgICBzZXRTZWxlY3RlZDogLT5cbiAgICAgICAgQGRpdi5jbGFzc0xpc3QuYWRkICdzZWxlY3RlZCdcbiAgICAgICAgQFxuICAgICAgICBcbiAgICBjbGVhclNlbGVjdGVkOiAtPlxuICAgICAgICBAZGl2LmNsYXNzTGlzdC5yZW1vdmUgJ3NlbGVjdGVkJ1xuICAgICAgICBAXG5cbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMCAgICAgMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICBcbiAgICAgICAgICAgIFxuICAgIGVkaXROYW1lOiA9PlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIEBpbnB1dD8gXG4gICAgICAgIEBpbnB1dCA9IGVsZW0gJ2lucHV0JyBjbGFzczoncm93TmFtZUlucHV0J1xuICAgICAgICBAaW5wdXQudmFsdWUgPSBzbGFzaC5maWxlIEBpdGVtLmZpbGVcbiAgICAgICAgXG4gICAgICAgIEBkaXYuYXBwZW5kQ2hpbGQgQGlucHV0XG4gICAgICAgIEBpbnB1dC5hZGRFdmVudExpc3RlbmVyICdjaGFuZ2UnICAgQFxuICAgICAgICBcbiAgICAgICAgQGlucHV0LmFkZEV2ZW50TGlzdGVuZXIgJ2tleWRvd24nICBAb25OYW1lS2V5RG93blxuICAgICAgICBAaW5wdXQuYWRkRXZlbnRMaXN0ZW5lciAnZm9jdXNvdXQnIEBvbk5hbWVGb2N1c091dFxuICAgICAgICBAaW5wdXQuZm9jdXMoKVxuICAgICAgICBcbiAgICAgICAgQGlucHV0LnNldFNlbGVjdGlvblJhbmdlIDAsIHNsYXNoLmJhc2UoQGl0ZW0uZmlsZSkubGVuZ3RoXG5cbiAgICBvbk5hbWVLZXlEb3duOiAoZXZlbnQpID0+XG4gICAgICAgIFxuICAgICAgICB7bW9kLCBrZXksIGNvbWJvfSA9IGtleWluZm8uZm9yRXZlbnQgZXZlbnRcblxuICAgICAgICBzd2l0Y2ggY29tYm9cbiAgICAgICAgICAgIHdoZW4gJ2VzYydcbiAgICAgICAgICAgICAgICBpZiBAaW5wdXQudmFsdWUgIT0gc2xhc2guZmlsZSBAaXRlbS5maWxlXG4gICAgICAgICAgICAgICAgICAgIEBpbnB1dC52YWx1ZSA9IHNsYXNoLmZpbGUgQGl0ZW0uZmlsZVxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpXG4gICAgICAgICAgICAgICAgQG9uTmFtZUZvY3VzT3V0KClcbiAgICAgICAgICAgIHdoZW4gJ2VudGVyJ1xuICAgICAgICAgICAgICAgIGlmIEBpbnB1dC52YWx1ZSAhPSBzbGFzaC5maWxlIEBpdGVtLmZpbGVcbiAgICAgICAgICAgICAgICAgICAgQG9uTmFtZUNoYW5nZSgpXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBAcmVtb3ZlSW5wdXQoKVxuICAgICAgICAgICAgICAgIHN0b3BFdmVudCBldmVudFxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICBcbiAgICByZW1vdmVJbnB1dDogLT5cblxuICAgICAgICByZXR1cm4gaWYgbm90IEBpbnB1dD9cbiAgICAgICAgQGlucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIgJ2ZvY3Vzb3V0JyBAb25OYW1lRm9jdXNPdXRcbiAgICAgICAgQGlucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIgJ2NoYW5nZScgICBAb25OYW1lQ2hhbmdlXG4gICAgICAgIEBpbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyICdrZXlkb3duJyAgQG9uTmFtZUtleURvd25cbiAgICAgICAgQGlucHV0LnJlbW92ZSgpXG4gICAgICAgIGRlbGV0ZSBAaW5wdXRcbiAgICAgICAgQGlucHV0ID0gbnVsbFxuICAgICAgICBpZiBub3QgZG9jdW1lbnQuYWN0aXZlRWxlbWVudD8gb3IgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PSBkb2N1bWVudC5ib2R5XG4gICAgICAgICAgICBAY29sdW1uLmZvY3VzIGFjdGl2YXRlOmZhbHNlXG4gICAgXG4gICAgb25OYW1lRm9jdXNPdXQ6IChldmVudCkgPT4gQHJlbW92ZUlucHV0KClcbiAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBvbk5hbWVDaGFuZ2U6IChldmVudCkgPT5cbiAgICAgICAgXG4gICAgICAgIHRhcmdldEZpbGUgPSBzbGFzaC5qb2luIHNsYXNoLmRpcihAaXRlbS5maWxlKSwgQGlucHV0LnZhbHVlLnRyaW0oKVxuICAgICAgICBcbiAgICAgICAgQHJlbW92ZUlucHV0KClcbiAgICAgICAgXG4gICAgICAgIEByZW5hbWUgdGFyZ2V0RmlsZVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMCAgICAgMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAwIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICBcbiAgICBcbiAgICByZW5hbWU6ICh0YXJnZXRGaWxlKSA9PlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIHNsYXNoLnNhbWVQYXRoIEBpdGVtLmZpbGUsIHRhcmdldEZpbGVcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgRmlsZS5yZW5hbWUgQGl0ZW0uZmlsZSwgdGFyZ2V0RmlsZSwgKHNvdXJjZSwgdGFyZ2V0KSA9PlxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAY29sdW1uLnJlbW92ZVJvdyBAXG4gICAgICAgICAgICBAYnJvd3Nlci5uYXZpZ2F0ZVRvRmlsZSB0YXJnZXRcbiAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIFxuICAgIFxuICAgICMgb25Nb3VzZURvd246IChldmVudCkgPT5cbiMgICAgICAgICBcbiAgICAgICAgIyBrbG9nICdvbk1vdXNlRG93bicgZXZlbnQuc2hpZnRLZXksIGV2ZW50LmFsdEtleSwgZXZlbnQuY3RybEtleVxuIyAgICAgICAgIFxuICAgICAgICAjIGlmIGV2ZW50LnNoaWZ0S2V5XG4gICAgICAgICAgICAjIEBicm93c2VyLnNlbGVjdC50byBAXG4gICAgICAgICMgZWxzZSBpZiBldmVudC5tZXRhS2V5IG9yIGV2ZW50LmFsdEtleSBvciBldmVudC5jdHJsS2V5XG4gICAgICAgICAgICAjIEBicm93c2VyLnNlbGVjdC50b2dnbGUgQFxuICAgICAgICAjIGVsc2VcbiAgICAgICAgICAgICMgQGJyb3dzZXIuc2VsZWN0LnJvdyBALCBmYWxzZVxuIyAgICAgXG4gICAgIyBvbkRyYWdTdGFydDogKGV2ZW50KSA9PlxuIyAgICAgICAgIFxuICAgICAgICAjIGtsb2cgJ2RyYWdTdGFydCcgZXZlbnQuc2hpZnRLZXlcbiMgICAgICAgICBcbiAgICAgICAgIyBpZiBlbXB0eSBAYnJvd3Nlci5zZWxlY3QuZmlsZXMoKVxuICAgICAgICAgICAgIyBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICAjIHJldHVybiBcbiMgICAgICAgICBcbiAgICAgICAgIyBpZiBub3QgQGlzU2VsZWN0ZWQoKVxuICAgICAgICAgICAgIyBAY29sdW1uLm9uQ2xpY2sgZXZlbnRcbiAgICAgICAgIyBrbG9nICdkcmFnU3RhcnQnIEBpc0FjdGl2ZSgpLCBAaXNTZWxlY3RlZCgpLCBAYnJvd3Nlci5zZWxlY3QuZmlsZXMoKVxuIyAgICAgICAgIFxuICAgICAgICAjIGV2ZW50LmRhdGFUcmFuc2Zlci5zZXREYXRhICd0ZXh0L3BsYWluJyBAYnJvd3Nlci5zZWxlY3QuZmlsZXMoKS5qb2luICdcXG4nXG5cbiAgICAgICAgIyBAY29sdW1uLmZvY3VzIGFjdGl2YXRlOmZhbHNlXG4gICAgICAgICMgQHNldEFjdGl2ZSBzY3JvbGw6ZmFsc2VcbiMgICAgICAgICBcbiAgICAjIG9uRHJhZ092ZXI6IChldmVudCkgPT5cbiMgICAgICAgICBcbiAgICAgICAgIyBldmVudC5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoJ1NoaWZ0JykgYW5kICdjb3B5JyBvciAnbW92ZSdcbiAgICAgICAgIyBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4jICAgICAgICAgXG4gICAgIyBvbkRyb3A6IChldmVudCkgPT4gXG4jICAgICBcbiAgICAgICAgIyBpZiBAY29sdW1uLmluZGV4IDwgMCBhbmQgbm90IGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoJ1NoaWZ0JykgYW5kIG5vdCBldmVudC5nZXRNb2RpZmllclN0YXRlKCdDb250cm9sJylcbiAgICAgICAgICAgICMgQGNvbHVtbi5vbkRyb3AgZXZlbnRcbiAgICAgICAgICAgICMgcmV0dXJuXG4jICAgICAgICAgICAgIFxuICAgICAgICAjIGFjdGlvbiA9IGV2ZW50LmdldE1vZGlmaWVyU3RhdGUoJ1NoaWZ0JykgYW5kICdjb3B5JyBvciAnbW92ZSdcbiAgICAgICAgIyB0YXJnZXQgPSBAaXRlbT8uZmlsZVxuICAgICAgICAjIHNvdXJjZSA9IGV2ZW50LmRhdGFUcmFuc2Zlci5nZXREYXRhICd0ZXh0L3BsYWluJ1xuICAgICAgICAjIEBicm93c2VyLmRyb3BBY3Rpb24gZXZlbnQsIEBpdGVtPy5maWxlXG4gICAgICAgICMgc3RvcEV2ZW50IGV2ZW50XG5cbm1vZHVsZS5leHBvcnRzID0gUm93XG4iXX0=
//# sourceURL=../coffee/row.coffee