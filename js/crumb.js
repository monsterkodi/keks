// koffee 1.4.0

/*
 0000000  00000000   000   000  00     00  0000000  
000       000   000  000   000  000   000  000   000
000       0000000    000   000  000000000  0000000  
000       000   000  000   000  000 0 000  000   000
 0000000  000   000   0000000   000   000  0000000
 */
var $, Crumb, File, elem, klog, kpos, ref, slash,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), slash = ref.slash, elem = ref.elem, kpos = ref.kpos, klog = ref.klog, $ = ref.$;

File = require('./tools/file');

Crumb = (function() {
    function Crumb(column) {
        this.column = column;
        this.onClick = bind(this.onClick, this);
        this.elem = elem({
            "class": 'crumb'
        });
        this.elem.columnIndex = this.column.index;
        this.elem.addEventListener('click', this.onClick);
        $('crumbs').appendChild(this.elem);
    }

    Crumb.prototype.onClick = function(event) {
        var br, root;
        if (this.column.index === 0) {
            if (event.target.id) {
                return this.column.browser.browse(event.target.id);
            } else {
                root = this.elem.firstChild;
                br = root.getBoundingClientRect();
                if (kpos(event).x < br.left) {
                    return this.column.browser.browse(root.id);
                } else {
                    return this.column.browser.browse(this.column.parent.file);
                }
            }
        } else {
            return this.column.makeRoot();
        }
    };

    Crumb.prototype.setFile = function(file) {
        if (this.column.index === 0) {
            return this.elem.innerHTML = File.crumbSpan(slash.tilde(file));
        } else {
            return this.elem.innerHTML = slash.base(file);
        }
    };

    Crumb.prototype.clear = function() {
        return this.elem.innerHTML = '';
    };

    Crumb.prototype.updateRect = function(br) {
        var width;
        this.elem.style.left = br.left + "px";
        if (this.column.index === this.column.browser.numCols() - 1) {
            width = br.right - br.left - 135;
            this.elem.style.width = width + "px";
            if (width < 50) {
                return this.elem.style.display = 'none';
            } else {
                return this.elem.style.display = null;
            }
        } else {
            return this.elem.style.width = (br.right - br.left) + "px";
        }
    };

    return Crumb;

})();

module.exports = Crumb;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3J1bWIuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7QUFBQSxJQUFBLDRDQUFBO0lBQUE7O0FBUUEsTUFBaUMsT0FBQSxDQUFRLEtBQVIsQ0FBakMsRUFBRSxpQkFBRixFQUFTLGVBQVQsRUFBZSxlQUFmLEVBQXFCLGVBQXJCLEVBQTJCOztBQUUzQixJQUFBLEdBQU8sT0FBQSxDQUFRLGNBQVI7O0FBRUQ7SUFFQyxlQUFDLE1BQUQ7UUFBQyxJQUFDLENBQUEsU0FBRDs7UUFFQSxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUEsQ0FBSztZQUFBLENBQUEsS0FBQSxDQUFBLEVBQU0sT0FBTjtTQUFMO1FBQ1IsSUFBQyxDQUFBLElBQUksQ0FBQyxXQUFOLEdBQW9CLElBQUMsQ0FBQSxNQUFNLENBQUM7UUFDNUIsSUFBQyxDQUFBLElBQUksQ0FBQyxnQkFBTixDQUF1QixPQUF2QixFQUErQixJQUFDLENBQUEsT0FBaEM7UUFDQSxDQUFBLENBQUUsUUFBRixDQUFXLENBQUMsV0FBWixDQUF3QixJQUFDLENBQUEsSUFBekI7SUFMRDs7b0JBT0gsT0FBQSxHQUFTLFNBQUMsS0FBRDtBQUVMLFlBQUE7UUFBQSxJQUFHLElBQUMsQ0FBQSxNQUFNLENBQUMsS0FBUixLQUFpQixDQUFwQjtZQUNJLElBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFoQjt1QkFDSSxJQUFDLENBQUEsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFoQixDQUF1QixLQUFLLENBQUMsTUFBTSxDQUFDLEVBQXBDLEVBREo7YUFBQSxNQUFBO2dCQUdJLElBQUEsR0FBTyxJQUFDLENBQUEsSUFBSSxDQUFDO2dCQUNiLEVBQUEsR0FBSyxJQUFJLENBQUMscUJBQUwsQ0FBQTtnQkFDTCxJQUFHLElBQUEsQ0FBSyxLQUFMLENBQVcsQ0FBQyxDQUFaLEdBQWdCLEVBQUUsQ0FBQyxJQUF0QjsyQkFDSSxJQUFDLENBQUEsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFoQixDQUF1QixJQUFJLENBQUMsRUFBNUIsRUFESjtpQkFBQSxNQUFBOzJCQUdJLElBQUMsQ0FBQSxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQWhCLENBQXVCLElBQUMsQ0FBQSxNQUFNLENBQUMsTUFBTSxDQUFDLElBQXRDLEVBSEo7aUJBTEo7YUFESjtTQUFBLE1BQUE7bUJBV0ksSUFBQyxDQUFBLE1BQU0sQ0FBQyxRQUFSLENBQUEsRUFYSjs7SUFGSzs7b0JBZVQsT0FBQSxHQUFTLFNBQUMsSUFBRDtRQUVMLElBQUcsSUFBQyxDQUFBLE1BQU0sQ0FBQyxLQUFSLEtBQWlCLENBQXBCO21CQUNJLElBQUMsQ0FBQSxJQUFJLENBQUMsU0FBTixHQUFrQixJQUFJLENBQUMsU0FBTCxDQUFlLEtBQUssQ0FBQyxLQUFOLENBQVksSUFBWixDQUFmLEVBRHRCO1NBQUEsTUFBQTttQkFHSSxJQUFDLENBQUEsSUFBSSxDQUFDLFNBQU4sR0FBa0IsS0FBSyxDQUFDLElBQU4sQ0FBVyxJQUFYLEVBSHRCOztJQUZLOztvQkFPVCxLQUFBLEdBQU8sU0FBQTtlQUFHLElBQUMsQ0FBQSxJQUFJLENBQUMsU0FBTixHQUFrQjtJQUFyQjs7b0JBRVAsVUFBQSxHQUFZLFNBQUMsRUFBRDtBQUVSLFlBQUE7UUFBQSxJQUFDLENBQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFaLEdBQXNCLEVBQUUsQ0FBQyxJQUFKLEdBQVM7UUFDOUIsSUFBRyxJQUFDLENBQUEsTUFBTSxDQUFDLEtBQVIsS0FBaUIsSUFBQyxDQUFBLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBaEIsQ0FBQSxDQUFBLEdBQTBCLENBQTlDO1lBQ0ksS0FBQSxHQUFRLEVBQUUsQ0FBQyxLQUFILEdBQVcsRUFBRSxDQUFDLElBQWQsR0FBcUI7WUFDN0IsSUFBQyxDQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBWixHQUF1QixLQUFELEdBQU87WUFDN0IsSUFBRyxLQUFBLEdBQVEsRUFBWDt1QkFDSSxJQUFDLENBQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFaLEdBQXNCLE9BRDFCO2FBQUEsTUFBQTt1QkFHSSxJQUFDLENBQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFaLEdBQXNCLEtBSDFCO2FBSEo7U0FBQSxNQUFBO21CQVFJLElBQUMsQ0FBQSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQVosR0FBc0IsQ0FBQyxFQUFFLENBQUMsS0FBSCxHQUFXLEVBQUUsQ0FBQyxJQUFmLENBQUEsR0FBb0IsS0FSOUM7O0lBSFE7Ozs7OztBQWFoQixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAwMCAgICAgMDAgIDAwMDAwMDAgIFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuMDAwICAgICAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgIFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDAgIDAwMCAgIDAwMFxuIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgIFxuIyMjXG5cbnsgc2xhc2gsIGVsZW0sIGtwb3MsIGtsb2csICQgfSA9IHJlcXVpcmUgJ2t4aydcblxuRmlsZSA9IHJlcXVpcmUgJy4vdG9vbHMvZmlsZSdcblxuY2xhc3MgQ3J1bWJcblxuICAgIEA6IChAY29sdW1uKSAtPlxuICAgICAgICBcbiAgICAgICAgQGVsZW0gPSBlbGVtIGNsYXNzOidjcnVtYidcbiAgICAgICAgQGVsZW0uY29sdW1uSW5kZXggPSBAY29sdW1uLmluZGV4XG4gICAgICAgIEBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgJ2NsaWNrJyBAb25DbGlja1xuICAgICAgICAkKCdjcnVtYnMnKS5hcHBlbmRDaGlsZCBAZWxlbVxuXG4gICAgb25DbGljazogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAgaWYgQGNvbHVtbi5pbmRleCA9PSAwXG4gICAgICAgICAgICBpZiBldmVudC50YXJnZXQuaWRcbiAgICAgICAgICAgICAgICBAY29sdW1uLmJyb3dzZXIuYnJvd3NlIGV2ZW50LnRhcmdldC5pZFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJvb3QgPSBAZWxlbS5maXJzdENoaWxkXG4gICAgICAgICAgICAgICAgYnIgPSByb290LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgICAgICAgICAgaWYga3BvcyhldmVudCkueCA8IGJyLmxlZnRcbiAgICAgICAgICAgICAgICAgICAgQGNvbHVtbi5icm93c2VyLmJyb3dzZSByb290LmlkXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBAY29sdW1uLmJyb3dzZXIuYnJvd3NlIEBjb2x1bW4ucGFyZW50LmZpbGVcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQGNvbHVtbi5tYWtlUm9vdCgpXG4gICAgICAgIFxuICAgIHNldEZpbGU6IChmaWxlKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQGNvbHVtbi5pbmRleCA9PSAwXG4gICAgICAgICAgICBAZWxlbS5pbm5lckhUTUwgPSBGaWxlLmNydW1iU3BhbiBzbGFzaC50aWxkZSBmaWxlXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBlbGVtLmlubmVySFRNTCA9IHNsYXNoLmJhc2UgZmlsZVxuICAgICAgICBcbiAgICBjbGVhcjogLT4gQGVsZW0uaW5uZXJIVE1MID0gJydcbiAgICBcbiAgICB1cGRhdGVSZWN0OiAoYnIpIC0+XG4gICAgICAgIFxuICAgICAgICBAZWxlbS5zdHlsZS5sZWZ0ID0gXCIje2JyLmxlZnR9cHhcIlxuICAgICAgICBpZiBAY29sdW1uLmluZGV4ID09IEBjb2x1bW4uYnJvd3Nlci5udW1Db2xzKCktMVxuICAgICAgICAgICAgd2lkdGggPSBici5yaWdodCAtIGJyLmxlZnQgLSAxMzVcbiAgICAgICAgICAgIEBlbGVtLnN0eWxlLndpZHRoID0gXCIje3dpZHRofXB4XCJcbiAgICAgICAgICAgIGlmIHdpZHRoIDwgNTBcbiAgICAgICAgICAgICAgICBAZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgQGVsZW0uc3R5bGUuZGlzcGxheSA9IG51bGxcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQGVsZW0uc3R5bGUud2lkdGggPSBcIiN7YnIucmlnaHQgLSBici5sZWZ0fXB4XCJcbiAgICAgICAgXG5tb2R1bGUuZXhwb3J0cyA9IENydW1iXG4iXX0=
//# sourceURL=../coffee/crumb.coffee